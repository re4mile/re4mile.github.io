<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="IDCè„šæœ¬å‚è€ƒé“¾æ¥ğŸ§¡å‚è€ƒé“¾æ¥: lyshark  https:&#x2F;&#x2F;www.cnblogs.com&#x2F;LyShark&#x2F;p&#x2F;13100048.html https:&#x2F;&#x2F;introspelliam.github.io&#x2F;2017&#x2F;09&#x2F;18&#x2F;tools&#x2F;IDA%E7%9A%84%E8%B0%83%E8%AF%95%E8%84%9A%E6%9C%ACidc&#x2F; åœ¨IDAä¸­æŒ‰ä¸‹ã€shift + F2ã€‘å¯è°ƒå‡ºè„šæœ¬">
<meta property="og:type" content="article">
<meta property="og:title" content="IDCè„šæœ¬å­¦ä¹ ">
<meta property="og:url" content="https://gitee.com/re4mile/re4mile.git/2022/12/05/Reverse-Tool-IDC%E8%84%9A%E6%9C%AC/index.html">
<meta property="og:site_name" content="re4mile">
<meta property="og:description" content="IDCè„šæœ¬å‚è€ƒé“¾æ¥ğŸ§¡å‚è€ƒé“¾æ¥: lyshark  https:&#x2F;&#x2F;www.cnblogs.com&#x2F;LyShark&#x2F;p&#x2F;13100048.html https:&#x2F;&#x2F;introspelliam.github.io&#x2F;2017&#x2F;09&#x2F;18&#x2F;tools&#x2F;IDA%E7%9A%84%E8%B0%83%E8%AF%95%E8%84%9A%E6%9C%ACidc&#x2F; åœ¨IDAä¸­æŒ‰ä¸‹ã€shift + F2ã€‘å¯è°ƒå‡ºè„šæœ¬">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="f:\5008\GItee\res\photo\Reverse-Tool-IDA-IDC\image-20221213124838663.png">
<meta property="article:published_time" content="2022-12-04T16:00:00.000Z">
<meta property="article:modified_time" content="2022-12-16T08:53:35.413Z">
<meta property="article:author" content="D0g3.re4mile">
<meta property="article:tag" content="IDA">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="f:\5008\GItee\res\photo\Reverse-Tool-IDA-IDC\image-20221213124838663.png">
    
    
      
        
          <link rel="shortcut icon" href="https://s1.ax1x.com/2022/11/11/zCfRiT.png">
        
      
      
        
          <link rel="icon" type="image/png" href="https://s1.ax1x.com/2022/11/11/zCfRiT.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="https://s1.ax1x.com/2022/11/11/zCfRiT.png">
        
      
    
    <!-- title -->
    <title>IDCè„šæœ¬å­¦ä¹ </title>
    <!-- styles -->
    
<link rel="stylesheet" href="/re4mile/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/re4mile/">Home</a></li><!--
     --><!--
       --><li><a href="/re4mile/categories/">ç›®å½•</a></li><!--
     --><!--
       --><li><a href="/re4mile/tags/">æ ‡ç­¾</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://re4mile.notion.site/Recording-128f15b4906c43f19c64e7be1b6011cc">æ—¥å¸¸è®°å½•</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/re4mile/2022/12/05/Reverse-Pe-UPX/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/re4mile/2022/12/05/Reverse-%E5%8F%8D%E8%B0%83%E8%AF%95/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://gitee.com/re4mile/re4mile.git/2022/12/05/Reverse-Tool-IDC%E8%84%9A%E6%9C%AC/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://gitee.com/re4mile/re4mile.git/2022/12/05/Reverse-Tool-IDC%E8%84%9A%E6%9C%AC/&text=IDCè„šæœ¬å­¦ä¹ "><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://gitee.com/re4mile/re4mile.git/2022/12/05/Reverse-Tool-IDC%E8%84%9A%E6%9C%AC/&title=IDCè„šæœ¬å­¦ä¹ "><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://gitee.com/re4mile/re4mile.git/2022/12/05/Reverse-Tool-IDC%E8%84%9A%E6%9C%AC/&is_video=false&description=IDCè„šæœ¬å­¦ä¹ "><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=IDCè„šæœ¬å­¦ä¹ &body=Check out this article: https://gitee.com/re4mile/re4mile.git/2022/12/05/Reverse-Tool-IDC%E8%84%9A%E6%9C%AC/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://gitee.com/re4mile/re4mile.git/2022/12/05/Reverse-Tool-IDC%E8%84%9A%E6%9C%AC/&title=IDCè„šæœ¬å­¦ä¹ "><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://gitee.com/re4mile/re4mile.git/2022/12/05/Reverse-Tool-IDC%E8%84%9A%E6%9C%AC/&title=IDCè„šæœ¬å­¦ä¹ "><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://gitee.com/re4mile/re4mile.git/2022/12/05/Reverse-Tool-IDC%E8%84%9A%E6%9C%AC/&title=IDCè„šæœ¬å­¦ä¹ "><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://gitee.com/re4mile/re4mile.git/2022/12/05/Reverse-Tool-IDC%E8%84%9A%E6%9C%AC/&title=IDCè„šæœ¬å­¦ä¹ "><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://gitee.com/re4mile/re4mile.git/2022/12/05/Reverse-Tool-IDC%E8%84%9A%E6%9C%AC/&name=IDCè„šæœ¬å­¦ä¹ &description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://gitee.com/re4mile/re4mile.git/2022/12/05/Reverse-Tool-IDC%E8%84%9A%E6%9C%AC/&t=IDCè„šæœ¬å­¦ä¹ "><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#IDC%E8%84%9A%E6%9C%AC"><span class="toc-number">1.</span> <span class="toc-text">IDCè„šæœ¬</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5"><span class="toc-number">1.1.</span> <span class="toc-text">å‚è€ƒé“¾æ¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HeloWorld"><span class="toc-number">1.2.</span> <span class="toc-text">HeloWorld</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.3.</span> <span class="toc-text">æ•°æ®ç±»å‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C"><span class="toc-number">1.3.1.</span> <span class="toc-text">å­—ç¬¦ä¸²æ“ä½œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E7%BB%84"><span class="toc-number">1.3.2.</span> <span class="toc-text">æ•°ç»„</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.4.</span> <span class="toc-text">è¿ç®—ç¬¦</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%AE%9A%E4%B9%89"><span class="toc-number">1.5.</span> <span class="toc-text">å‡½æ•°å®šä¹‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%8F%E5%AE%9A%E4%B9%89"><span class="toc-number">1.6.</span> <span class="toc-text">å®å®šä¹‰</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#IDC-Example"><span class="toc-number">2.</span> <span class="toc-text">IDC-Example</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#patch"><span class="toc-number">2.1.</span> <span class="toc-text">patch</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AB%98%E4%BA%AE"><span class="toc-number">2.2.</span> <span class="toc-text">é«˜äº®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dump%E6%95%B0%E6%8D%AE"><span class="toc-number">2.3.</span> <span class="toc-text">dumpæ•°æ®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E6%87%82"><span class="toc-number">2.4.</span> <span class="toc-text">ä¸æ‡‚</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#IDC-API"><span class="toc-number">3.</span> <span class="toc-text">IDC-API</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%8B%E5%86%8C"><span class="toc-number">3.1.</span> <span class="toc-text">æ‰‹å†Œ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%8F%96%E4%BF%AE%E6%94%B9"><span class="toc-number">3.2.</span> <span class="toc-text">æ•°æ®è¯»å–ä¿®æ”¹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PatchByte-x2F-Word-x2F-Dword"><span class="toc-number">3.2.1.</span> <span class="toc-text">PatchByte&#x2F;Word&#x2F;Dword</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Byte-x2F-Word-x2F-Dword"><span class="toc-number">3.2.2.</span> <span class="toc-text">Byte&#x2F;Word&#x2F;Dword</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#isLoaded"><span class="toc-number">3.2.3.</span> <span class="toc-text">isLoaded</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E4%BA%A4%E4%BA%92%E5%87%BD%E6%95%B0"><span class="toc-number">3.3.</span> <span class="toc-text">ç”¨æˆ·äº¤äº’å‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Message"><span class="toc-number">3.3.1.</span> <span class="toc-text">Message</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#print"><span class="toc-number">3.3.2.</span> <span class="toc-text">print</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#warning"><span class="toc-number">3.3.3.</span> <span class="toc-text">warning</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AskStr"><span class="toc-number">3.3.4.</span> <span class="toc-text">AskStr</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AskFile"><span class="toc-number">3.3.5.</span> <span class="toc-text">AskFile</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AskYN"><span class="toc-number">3.3.6.</span> <span class="toc-text">AskYN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ScreenEA"><span class="toc-number">3.3.7.</span> <span class="toc-text">ScreenEA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jump"><span class="toc-number">3.3.8.</span> <span class="toc-text">Jump</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C%E5%87%BD%E6%95%B0"><span class="toc-number">3.4.</span> <span class="toc-text">å­—ç¬¦ä¸²æ“ä½œå‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#form"><span class="toc-number">3.4.1.</span> <span class="toc-text">form</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sprintf"><span class="toc-number">3.4.2.</span> <span class="toc-text">sprintf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#atol"><span class="toc-number">3.4.3.</span> <span class="toc-text">atol</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xtol"><span class="toc-number">3.4.4.</span> <span class="toc-text">xtol</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ltoa"><span class="toc-number">3.4.5.</span> <span class="toc-text">ltoa</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ord"><span class="toc-number">3.4.6.</span> <span class="toc-text">ord</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#strlen"><span class="toc-number">3.4.7.</span> <span class="toc-text">strlen</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#strstr"><span class="toc-number">3.4.8.</span> <span class="toc-text">strstr</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#substr"><span class="toc-number">3.4.9.</span> <span class="toc-text">substr</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="toc-number">3.5.</span> <span class="toc-text">æ–‡ä»¶æ“ä½œ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#fopen"><span class="toc-number">3.5.1.</span> <span class="toc-text">fopen</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fclose"><span class="toc-number">3.5.2.</span> <span class="toc-text">fclose</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#filelength"><span class="toc-number">3.5.3.</span> <span class="toc-text">filelength</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fgetc"><span class="toc-number">3.5.4.</span> <span class="toc-text">fgetc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fputc"><span class="toc-number">3.5.5.</span> <span class="toc-text">fputc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fprintf"><span class="toc-number">3.5.6.</span> <span class="toc-text">fprintf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#writestr"><span class="toc-number">3.5.7.</span> <span class="toc-text">writestr</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#readstr"><span class="toc-number">3.5.8.</span> <span class="toc-text">readstr</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#writelong"><span class="toc-number">3.5.9.</span> <span class="toc-text">writelong</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#readlong"><span class="toc-number">3.5.10.</span> <span class="toc-text">readlong</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#writeshort"><span class="toc-number">3.5.11.</span> <span class="toc-text">writeshort</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#readshort"><span class="toc-number">3.5.12.</span> <span class="toc-text">readshort</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#loadfile"><span class="toc-number">3.5.13.</span> <span class="toc-text">loadfile</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#savefile"><span class="toc-number">3.5.14.</span> <span class="toc-text">savefile</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8D%E7%A7%B0"><span class="toc-number">3.6.</span> <span class="toc-text">æ“ä½œæ•°æ®åº“åç§°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Name"><span class="toc-number">3.6.1.</span> <span class="toc-text">Name</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NameEx"><span class="toc-number">3.6.2.</span> <span class="toc-text">NameEx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MakeNameEx"><span class="toc-number">3.6.3.</span> <span class="toc-text">MakeNameEx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LocByName"><span class="toc-number">3.6.4.</span> <span class="toc-text">LocByName</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LocByNameEx"><span class="toc-number">3.6.5.</span> <span class="toc-text">LocByNameEx</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%87%BD%E6%95%B0"><span class="toc-number">3.7.</span> <span class="toc-text">æ“ä½œæ•°æ®åº“çš„å‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MakeUnkn"><span class="toc-number">3.7.1.</span> <span class="toc-text">MakeUnkn</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MakeCode"><span class="toc-number">3.7.2.</span> <span class="toc-text">MakeCode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MakeByte"><span class="toc-number">3.7.3.</span> <span class="toc-text">MakeByte</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MakeComm"><span class="toc-number">3.7.4.</span> <span class="toc-text">MakeComm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MakeFunction"><span class="toc-number">3.7.5.</span> <span class="toc-text">MakeFunction</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MakeStr"><span class="toc-number">3.7.6.</span> <span class="toc-text">MakeStr</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%90%9C%E7%B4%A2%E5%87%BD%E6%95%B0"><span class="toc-number">3.8.</span> <span class="toc-text">æ•°æ®åº“æœç´¢å‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#FindCode"><span class="toc-number">3.8.1.</span> <span class="toc-text">FindCode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FindData"><span class="toc-number">3.8.2.</span> <span class="toc-text">FindData</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FindBinary"><span class="toc-number">3.8.3.</span> <span class="toc-text">FindBinary</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FindText"><span class="toc-number">3.8.4.</span> <span class="toc-text">FindText</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E5%87%BD%E6%95%B0"><span class="toc-number">3.9.</span> <span class="toc-text">æ“ä½œå‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GetFunctionAttr"><span class="toc-number">3.9.1.</span> <span class="toc-text">GetFunctionAttr</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GetFunctionName"><span class="toc-number">3.9.2.</span> <span class="toc-text">GetFunctionName</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NextFunction"><span class="toc-number">3.9.3.</span> <span class="toc-text">NextFunction</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PrevFunction"><span class="toc-number">3.9.4.</span> <span class="toc-text">PrevFunction</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E4%BA%A4%E5%8F%89%E5%BC%95%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-number">3.10.</span> <span class="toc-text">ä»£ç äº¤å‰å¼•ç”¨å‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Rfirst"><span class="toc-number">3.10.1.</span> <span class="toc-text">Rfirst</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Rnext"><span class="toc-number">3.10.2.</span> <span class="toc-text">Rnext</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XrefType"><span class="toc-number">3.10.3.</span> <span class="toc-text">XrefType</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RfirstB"><span class="toc-number">3.10.4.</span> <span class="toc-text">RfirstB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RnextB"><span class="toc-number">3.10.5.</span> <span class="toc-text">RnextB</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BA%A4%E5%8F%89%E5%BC%95%E7%94%A8"><span class="toc-number">3.11.</span> <span class="toc-text">æ•°æ®äº¤å‰å¼•ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Dfirst"><span class="toc-number">3.11.1.</span> <span class="toc-text">Dfirst</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dnext"><span class="toc-number">3.11.2.</span> <span class="toc-text">Dnext</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XrefType-1"><span class="toc-number">3.11.3.</span> <span class="toc-text">XrefType()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DfirstB"><span class="toc-number">3.11.4.</span> <span class="toc-text">DfirstB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DnextB"><span class="toc-number">3.11.5.</span> <span class="toc-text">DnextB</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E6%B1%87%E7%BC%96%E6%8F%90%E5%8F%96"><span class="toc-number">3.12.</span> <span class="toc-text">åæ±‡ç¼–æå–</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GetDisasm"><span class="toc-number">3.12.1.</span> <span class="toc-text">GetDisasm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GetMnem"><span class="toc-number">3.12.2.</span> <span class="toc-text">GetMnem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GetOpnd"><span class="toc-number">3.12.3.</span> <span class="toc-text">GetOpnd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GetOpType"><span class="toc-number">3.12.4.</span> <span class="toc-text">GetOpType</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GetOperandValue"><span class="toc-number">3.12.5.</span> <span class="toc-text">GetOperandValue</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-func"><span class="toc-number">3.13.</span> <span class="toc-text">misc-func</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%99%84%E5%BD%95"><span class="toc-number">4.</span> <span class="toc-text">é™„å½•</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        IDCè„šæœ¬å­¦ä¹ 
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">D0g3.re4mile</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2022-12-04T16:00:00.000Z" itemprop="datePublished">2022-12-05</time>
        
        (Updated: <time datetime="2022-12-16T08:53:35.413Z" itemprop="dateModified">2022-12-16</time>)
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/re4mile/categories/Tool/">Tool</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/re4mile/tags/IDA/" rel="tag">IDA</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="IDCè„šæœ¬"><a href="#IDCè„šæœ¬" class="headerlink" title="IDCè„šæœ¬"></a>IDCè„šæœ¬</h1><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p>ğŸ§¡å‚è€ƒé“¾æ¥: lyshark  <a target="_blank" rel="noopener" href="https://www.cnblogs.com/LyShark/p/13100048.html">https://www.cnblogs.com/LyShark/p/13100048.html</a></p>
<p><a target="_blank" rel="noopener" href="https://introspelliam.github.io/2017/09/18/tools/IDA%E7%9A%84%E8%B0%83%E8%AF%95%E8%84%9A%E6%9C%ACidc/">https://introspelliam.github.io/2017/09/18/tools/IDA%E7%9A%84%E8%B0%83%E8%AF%95%E8%84%9A%E6%9C%ACidc/</a></p>
<p>åœ¨IDAä¸­æŒ‰ä¸‹ã€shift + F2ã€‘å¯è°ƒå‡ºè„šæœ¬ç¼–è¾‘å™¨</p>
<h2 id="HeloWorld"><a href="#HeloWorld" class="headerlink" title="HeloWorld"></a>HeloWorld</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt; idc&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">     Message(<span class="string">&quot;HelloWorld \n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h2><p>IDCä¸­æ‰€æœ‰å˜é‡éƒ½è¢«å®šä¹‰æˆautoç±»å‹ï¼Œä¼šè‡ªåŠ¨è¿›è¡Œç±»å‹è½¬æ¢ï¼Œä¸€èˆ¬ç±»å‹æœ‰æ•´æ•°å‹ã€å­—ç¬¦ä¸²ç±»å‹ã€æµ®ç‚¹å‹</p>
<p>å˜é‡åœ¨æ²¡æœ‰èµ‹äºˆåˆå§‹å€¼çš„æƒ…å†µä¸‹,ä¸º0</p>
<ul>
<li><p>å±€éƒ¨å˜é‡ï¼šauto counter;</p>
</li>
<li><p>extern å¼•å…¥å…¨å±€å˜é‡çš„å£°æ˜ï¼Œextern outsideGlobal;</p>
</li>
<li><p>å­—ç¬¦ä¸²æ”¯æŒåŠ å¥½è¿æ¥ï¼šauto str &#x3D; â€œhelloâ€ + â€œworldâ€;</p>
</li>
<li><p>å­—ç¬¦ä¸²æ”¯æŒåˆ†ç‰‡æ“ä½œï¼šstr1 &#x3D; str[7:9];</p>
</li>
<li><p>æ²¡æœ‰strcatâ€¦ç­‰ç­‰å‡½æ•°</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> addr, reg, val;    <span class="comment">//æ²¡æœ‰åˆå§‹åŒ–å£°æ˜çš„å¤šä¸ªå˜é‡</span></span><br><span class="line"><span class="keyword">auto</span> count = <span class="number">0</span>;         <span class="comment">//å·²å£°æ˜å’Œåˆå§‹åŒ–</span></span><br></pre></td></tr></table></figure>



<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> outsideGlobal;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">extern</span> insideGlobal;</span><br><span class="line">	outsideGlobal = <span class="string">&quot;Global&quot;</span>;</span><br><span class="line">	insideGlobal = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>è™½ç„¶IDCæ²¡æœ‰æ•°ç»„æ•°æ®ç±»å‹,ä½†ä½ å¯ä»¥ä½¿ç”¨åˆ†ç‰‡è¿ç®—ç¬¦æ¥å¤„ç†IDCå­—ç¬¦ä¸²,</p>
<p>å°±å¥½åƒä»–ä»¬æ˜¯æ•°ç»„ä¸€æ ·,IDCåˆ†ç‰‡çš„ç”¨æ³•ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> str = <span class="string">&quot;String to slice&quot;</span>;</span><br><span class="line"><span class="keyword">auto</span> s1, s2, s3, s4;</span><br><span class="line">s1 = str[<span class="number">7</span>:<span class="number">9</span>];          <span class="comment">//&#x27;to&#x27;</span></span><br><span class="line">s2 = str[ :<span class="number">6</span>];		   <span class="comment">//&#x27;String&#x27;</span></span><br><span class="line">s3 = str[<span class="number">10</span>: ];		   <span class="comment">//&#x27;slice&#x27;</span></span><br><span class="line">s4 = str[<span class="number">5</span>];		       <span class="comment">//&#x27;g&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="å­—ç¬¦ä¸²æ“ä½œ"><a href="#å­—ç¬¦ä¸²æ“ä½œ" class="headerlink" title="å­—ç¬¦ä¸²æ“ä½œ"></a>å­—ç¬¦ä¸²æ“ä½œ</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( op == <span class="string">&quot;jmp&quot;</span> || op == <span class="string">&quot;call&quot;</span> )</span><br><span class="line">&#123;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;idc.idc&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// æ ¼å¼åŒ–å­—ç¬¦ä¸²,ç±»ä¼¼äºsprintf</span></span><br><span class="line">    <span class="keyword">auto</span> name = form(<span class="string">&quot;hello %s&quot;</span>,<span class="string">&quot;lyshark&quot;</span>);</span><br><span class="line">    Message(<span class="string">&quot;æ ¼å¼åŒ–åçš„å†…å®¹: %s \n&quot;</span>,name);</span><br><span class="line">    </span><br><span class="line">    Message(<span class="string">&quot;åå…­è¿›åˆ¶è½¬ä¸ºæ•´æ•°: %d \n&quot;</span>,xtol(<span class="string">&quot;0x41&quot;</span>));</span><br><span class="line">    Message(<span class="string">&quot;åè¿›åˆ¶100è½¬ä¸ºå…«è¿›åˆ¶: %d \n&quot;</span>,ltoa(<span class="number">100</span>,<span class="number">8</span>));</span><br><span class="line">    Message(<span class="string">&quot;åè¿›åˆ¶100è½¬æ¢äºŒè¿›åˆ¶: %d \n&quot;</span>,ltoa(<span class="number">100</span>,<span class="number">2</span>));</span><br><span class="line">    Message(<span class="string">&quot;å­—ç¬¦Açš„ASCII: %d \n&quot;</span>,ord(<span class="string">&quot;A&quot;</span>));</span><br><span class="line">    Message(<span class="string">&quot;è®¡ç®—å­—ç¬¦ä¸²é•¿åº¦: %d \n&quot;</span>,<span class="built_in">strlen</span>(<span class="string">&quot;hello lyshark&quot;</span>));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åœ¨è‘—å­—ç¬¦ä¸²ä¸­å¯»æ‰¾å­ä¸²</span></span><br><span class="line">    <span class="keyword">auto</span> main = <span class="string">&quot;hello lyshark&quot;</span>;</span><br><span class="line">    <span class="keyword">auto</span> sub = <span class="string">&quot;lyshark&quot;</span>;</span><br><span class="line">    Message(<span class="string">&quot;å¯»æ‰¾å­ä¸²: %d \n&quot;</span>,<span class="built_in">strstr</span>(main,sub));</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h3><p>ä¸€ä¸ªä¾‹å­å°±å¯ä»¥ææ‡‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;idc.idc&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºæ•°ç»„å…ƒç´ </span></span><br><span class="line">    <span class="keyword">auto</span> ObjArr = CreateArray(<span class="string">&quot;array&quot;</span>);</span><br><span class="line">    <span class="comment">// è·å–æ•°ç»„æŒ‡é’ˆ</span></span><br><span class="line">    <span class="keyword">auto</span> lp_Arr = GetArrayId(<span class="string">&quot;array&quot;</span>);</span><br><span class="line"></span><br><span class="line">    Message(<span class="string">&quot;Arr: %X\n&quot;</span>, lp_Arr);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®ä¸¤ä¸ªå­—ç¬¦ä¸²å˜é‡</span></span><br><span class="line">    SetArrayString(lp_Arr, <span class="number">0</span>, <span class="string">&quot;hello&quot;</span>);</span><br><span class="line">    SetArrayString(lp_Arr, <span class="number">1</span>, <span class="string">&quot;re4mile&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®ä¸¤ä¸ªæ•´æ•°å˜é‡</span></span><br><span class="line">    SetArrayLong(lp_Arr, <span class="number">2</span>, <span class="number">100</span>);</span><br><span class="line">    SetArrayLong(lp_Arr, <span class="number">3</span>, <span class="number">200</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæå–å­—ç¬¦ä¸²ä½¿ç”¨ AR_STR æ ‡è®° ï¼Œæå–æ•´æ•°ä½¿ç”¨ AR_LONG</span></span><br><span class="line">    <span class="keyword">auto</span> sz1 = GetArrayElement(AR_STR, lp_Arr, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">auto</span> sz2 = GetArrayElement(AR_STR, lp_Arr, <span class="number">1</span>);</span><br><span class="line">    Message(<span class="string">&quot;å­—ç¬¦ä¸²: %s %s !\n&quot;</span>, sz1, sz2);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> num1 = GetArrayElement(AR_LONG, lp_Arr, <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">auto</span> num2 = GetArrayElement(AR_LONG, lp_Arr, <span class="number">3</span>);</span><br><span class="line">    Message(<span class="string">&quot;æ•´æ•°: %d %d\n&quot;</span>, num1,num2);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ é™¤æ•°ç»„çš„0å·å…ƒç´ </span></span><br><span class="line">    DelArrayElement(AR_STR, lp_Arr, <span class="number">0</span>);</span><br><span class="line">    <span class="comment">// æ³¨é”€æ•´ä¸ªæ•°ç»„</span></span><br><span class="line">    DeleteArray(lp_Arr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="è¿ç®—ç¬¦"><a href="#è¿ç®—ç¬¦" class="headerlink" title="è¿ç®—ç¬¦"></a>è¿ç®—ç¬¦</h2><p>è®¸å¤šæ ‡å‡†çš„Cè¯­è¨€æ“ä½œç¬¦ï¼ˆ+ã€-ã€*ã€&#x2F;ã€%ã€&lt;&lt;ã€&gt;&gt;ã€++ã€â€“ï¼‰åŒ…æ‹¬ä¸‰å…ƒè¿ç®—ç¬¦ï¼ˆ?:)</p>
<p>åœ¨IDCåŒæ ·é€‚ç”¨ï¼Œä½†å¤åˆèµ‹å€¼è¿ç®—ç¬¦<code>+=ä¸æ”¯æŒ</code>ã€<code>é€—å·æ“ä½œç¬¦ä¹Ÿä¸è¢«æ”¯æŒ</code>ã€‚</p>
<p>IDCå‡ ä¹æ”¯æŒCä¸­çš„æ‰€æœ‰è¿ç®—å’Œé€»è¾‘æ“ä½œç¬¦ï¼Œ<code>ä½†æ˜¯</code>æ‰€æœ‰æ•´æ•°æ“ä½œæ•°å‡ä½œä¸ºæœ‰ç¬¦å·çš„å€¼å¤„ç†ã€‚</p>
<p>è¿™ä¼šå½±å“åˆ°æ•´æ•°æ¯”è¾ƒä¸å³ç§»ä½è¿ç®—ã€‚å¦‚æœéœ€è¦è¿›è¡Œé€»è¾‘å³ç§»ä½è¿ç®—ï¼Œä½ å¿…é¡»ä¿®æ”¹ç»“æœçš„æœ€é«˜ä½ï¼Œè‡ªå·±ç§»ä½ï¼Œ</p>
<p>å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result = ( x &gt;&gt; <span class="number">1</span> ) &amp; <span class="number">0x7fffffff</span>;   <span class="comment">//å°†æœ€å¤§æœ‰æ•ˆä½è®¾ç½®ä¸º0</span></span><br></pre></td></tr></table></figure>

<p>ä¸Cè¯­è¨€ä¸€æ ·ï¼ŒIDCæ‰€æœ‰ç®€å•è¯­å¥å‡ä»¥åˆ†å·ç»“æŸã€‚</p>
<p>Switchè¯­å¥æ˜¯IDCå”¯ä¸€ä¸æ”¯æŒçš„Cé£æ ¼å¤åˆè¯­å¥ã€‚</p>
<p>åœ¨ä½¿ç”¨forè¯­å¥æ—¶IDCä¸æ”¯æŒå¤åˆèµ‹å€¼è¿ç®—ç¬¦ï¼Œå¦‚æœä½ å¸Œæœ›ä»¥é™¤1ä»¥å¤–çš„å…¶ä»–å€¼ä¸ºå•ä½è¿›è¡Œè®¡æ•°ï¼Œå°±éœ€è¦æ³¨æ„è¿™ä¸€ç‚¹ï¼Œ</p>
<p>å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> i;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i += <span class="number">2</span>) </span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">&#125;       <span class="comment">//ä¸åˆæ³•ï¼Œä¸æ”¯æŒ +=</span></span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i = i + <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">&#125;    <span class="comment">//åˆæ³•</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>







<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="å‡½æ•°å®šä¹‰"><a href="#å‡½æ•°å®šä¹‰" class="headerlink" title="å‡½æ•°å®šä¹‰"></a>å‡½æ•°å®šä¹‰</h2><p>å®šä¹‰ä¸€ä¸ªå‡½æ•°</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt; idc&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªå‡½æ•°</span></span><br><span class="line"><span class="type">static</span> <span class="title function_">OutPutAddress</span><span class="params">(My)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">auto</span> tmp;</span><br><span class="line"> 	tmp = <span class="number">0x1300</span> + My;</span><br><span class="line">    <span class="keyword">return</span> tmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">auto</span> ret = OutPutAddress(<span class="number">0x14</span>);</span><br><span class="line">    Message(<span class="string">&quot;%x \n&quot;</span>,ret);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="å®å®šä¹‰"><a href="#å®å®šä¹‰" class="headerlink" title="å®å®šä¹‰"></a>å®å®šä¹‰</h2><p>BADADDR &#x3D; -1</p>
<h1 id="IDC-Example"><a href="#IDC-Example" class="headerlink" title="IDC-Example"></a>IDC-Example</h1><p>è¿™ä¸ªå¸ˆå‚…å†™äº†å¾ˆå¤šçš„IDCä¾‹å­</p>
<p>ä½ è‡ªå·±å¯ä»¥è·Ÿç€å­¦ä¹ </p>
<h2 id="patch"><a href="#patch" class="headerlink" title="patch"></a>patch</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ–‡ä»¶åï¼štest.idc</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt; idc&gt;</span></span></span><br><span class="line"><span class="type">static</span> <span class="title function_">main</span><span class="params">()</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">auto</span> x,FBin,ProcRange;</span><br><span class="line">    FBin = <span class="string">&quot;E8 0A 00 00 00 E8 EB 0C 00 00 E8 F6 FF FF FF&quot;</span>;</span><br><span class="line">    <span class="comment">//ç›®æ ‡ = &quot;E8 0A tel:00 00 00 90 EB 0C tel:90 90 90 90 90 90 90&quot;;</span></span><br><span class="line">    <span class="comment">//èŠ±æŒ‡ä»¤1çš„ç‰¹å¾ç </span></span><br><span class="line">    <span class="keyword">for</span> (x = FindBinary(MinEA(),<span class="number">0x03</span>,FBin);x != BADADDR;x = FindBinary(x,<span class="number">0x03</span>,FBin))</span><br><span class="line">    &#123;</span><br><span class="line">            x=x+<span class="number">5</span>; <span class="comment">//è¿”å›çš„xæ˜¯ç¬¬ä¸€ä¸ªE8çš„åœ°å€ï¼Œ</span></span><br><span class="line">                  <span class="comment">//åŠ ä¸Š5æ˜¯ç¬¬äºŒä¸ªE8çš„åœ°å€</span></span><br><span class="line">            PatchByte (x,<span class="number">0x90</span>);<span class="comment">//nopæ‰</span></span><br><span class="line">            x = x + <span class="number">3</span>; <span class="comment">//00</span></span><br><span class="line">            PatchByte (x,<span class="number">0x90</span>);</span><br><span class="line">            x++;  <span class="comment">//00 E8</span></span><br><span class="line">            PatchWord (x,<span class="number">0x9090</span>);</span><br><span class="line">            x =x + <span class="number">2</span> ; <span class="comment">//F6 FF FF FF</span></span><br><span class="line">            PatchDword(x,<span class="number">0x90909090</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="é«˜äº®"><a href="#é«˜äº®" class="headerlink" title="é«˜äº®"></a>é«˜äº®</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;idc.idc&gt;</span></span></span><br><span class="line"><span class="type">static</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">auto</span> head, op;</span><br><span class="line">    head = NextHead(<span class="number">0x00000000</span>, <span class="number">0xFFFFFFFF</span>);</span><br><span class="line">    <span class="keyword">while</span> ( head != BADADDR )</span><br><span class="line">    &#123;</span><br><span class="line">        op = GetMnem(head);</span><br><span class="line">        Message(<span class="string">&quot;%x %s \n&quot;</span>,head,op);</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> ( op == <span class="string">&quot;jmp&quot;</span> || op == <span class="string">&quot;call&quot;</span> )</span><br><span class="line">            SetColor(head, CIC_ITEM, <span class="number">0x010187</span>);</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">if</span> (op == <span class="string">&quot;xor&quot;</span>)</span><br><span class="line">            SetColor(head, CIC_ITEM, <span class="number">0x010198</span>);</span><br><span class="line">        head = NextHead(head, <span class="number">0xFFFFFFFF</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>å°†å‡½æ•°çš„åå­—dumpåˆ°æœ¬åœ°,dumpå‡ºçš„æ–‡ä»¶åå­—æ˜¯xxxfile_name_dump.log</p>
<p>æ–‡ä»¶çš„è·¯å¾„ä¸ä½ çš„xxx.exeç›¸åŒ</p>
<h2 id="dumpæ•°æ®"><a href="#dumpæ•°æ®" class="headerlink" title="dumpæ•°æ®"></a>dumpæ•°æ®</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> i,fp;</span><br><span class="line">fp = fopen(<span class="string">&quot;d:\\dump.dex&quot;</span>,<span class="string">&quot;wb&quot;</span>);</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0x46B6D000</span>;i&lt;<span class="number">0x46B6f000</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line">    fputc(Byte(i),fp);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="ä¸æ‡‚"><a href="#ä¸æ‡‚" class="headerlink" title="ä¸æ‡‚"></a>ä¸æ‡‚</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;idc.idc&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> decode = <span class="number">0x401000</span>;</span><br><span class="line">	<span class="keyword">auto</span> xref;</span><br><span class="line">    Message(<span class="string">&quot;xref: start\n&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(xref = RfirstB(decode); xref != BADADDR; xref = RnextB(decode,xref))</span><br><span class="line">	&#123;</span><br><span class="line">		Message(<span class="string">&quot;xref: %x\n&quot;</span>,xref);<span class="comment">//äº¤å‰å¼•ç”¨çš„ä¸Šä¸€ä¸ªåœ°å€</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">auto</span> i = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">auto</span> inst = xref;</span><br><span class="line">		<span class="keyword">auto</span> op;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>((i &lt; <span class="number">100</span>) )</span><br><span class="line">		&#123;</span><br><span class="line">			inst	= FindCode(inst,<span class="number">0x00</span>); <span class="comment">// flag set to backwards</span></span><br><span class="line">			op		= GetDisasm(inst); <span class="comment">// get</span></span><br><span class="line">			Message(<span class="string">&quot;%x --&gt; %s \n&quot;</span>,inst,op);</span><br><span class="line">			i++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; </span><br><span class="line">	Message(<span class="string">&quot;xref: end&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h1 id="IDC-API"><a href="#IDC-API" class="headerlink" title="IDC-API"></a>IDC-API</h1><h2 id="æ‰‹å†Œ"><a href="#æ‰‹å†Œ" class="headerlink" title="æ‰‹å†Œ"></a>æ‰‹å†Œ</h2><p><a target="_blank" rel="noopener" href="https://www.hex-rays.com/products/ida/support/idadoc/162.shtml">https://www.hex-rays.com/products/ida/support/idadoc/162.shtml</a></p>
<p>å…¶å®å°±æ˜¯</p>
<p><img src="F:\5008\GItee\res\photo\Reverse-Tool-IDA-IDC\image-20221213124838663.png" alt="image-20221213124838663"></p>
<p>jmp åˆ°å½“å‰ä½ç½®+1</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">EB FF			jmp     <span class="type">short</span> near ptr loc_1144+<span class="number">1</span></span><br><span class="line">-------------------------------------------------------------</span><br><span class="line">                dw <span class="number">0B</span>FC0h</span><br><span class="line">                dq <span class="number">0F</span>FFEDFE800000068h, <span class="number">65B</span>FC0FFEBFFh, <span class="number">0F</span>FEBFFFFFED2E800h</span><br><span class="line">                dq <span class="number">0</span>C5E80000006CBFC0h, <span class="number">6</span>CBFC0FFEBFFFFFEh, <span class="number">0F</span>FFFFEB8E8000000h</span><br><span class="line">                dq <span class="number">6F</span>BFC0FFEBh, <span class="number">0</span>C0FFEBFFFFFEABE8h, <span class="number">0F</span>E9EE800000020BFh</span><br><span class="line">                dq <span class="number">77B</span>FC0FFEBFFFFh, <span class="number">0</span>EBFFFFFE91E80000h, <span class="number">0E80000006</span>FBFC0FFh</span><br></pre></td></tr></table></figure>

<p>ä»–çš„ç‰¹å¾ä»£ç æ˜¯<code>EB FF</code></p>
<p>EBæ˜¯jmp FFæ˜¯åç§»</p>
<p>äºæ˜¯è¿™ç§æ²¡æœ‰æ„ä¹‰çš„è·³è½¬åº”è¯¥ç»™nopæ‰</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">EB                                      db <span class="number">0</span>EBh</span><br><span class="line">;---------------------------------------------------------------------------</span><br><span class="line">FF C0                                   inc     eax</span><br><span class="line">BF <span class="number">68</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>                          mov     edi, <span class="number">68</span>h ; <span class="string">&#x27;h&#x27;</span></span><br><span class="line">E8 DF FE FF FF                          call    _putchar</span><br></pre></td></tr></table></figure>

<p>å¦‚æœç¨‹åºä¸­æœ‰å¤§é‡çš„è¿™ç§èŠ±æŒ‡ä»¤.é‚£ä¹ˆä½ ä¸å¯èƒ½æ‰‹åŠ¨çš„ä¸€ä¸ªä¸€ä¸ªå»nopæ‰</p>
<p>ç”¨è„šæœ¬</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt; idc&gt;</span></span></span><br><span class="line"><span class="type">static</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">auto</span> x, target_str, ProcRange;</span><br><span class="line">    target_str = <span class="string">&quot;EB FF C0 BF&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (x = FindBinary(MinEA(), <span class="number">0x03</span>, target_str); x != BADADDR; x = FindBinary(x, <span class="number">0x03</span>, target_str))</span><br><span class="line">    &#123;       </span><br><span class="line">        PatchByte(x, <span class="number">0x90</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>FindBinary(MinEA(), 0x03, target_str)çš„æ„æ€æ˜¯?</p>
<p>ä»åœ°å€MinEA()å¤„æŒ‰0x03çš„æ¨¡å¼éå†å­—èŠ‚ç target_str</p>
<p>MinEA()æ˜¯æœ€å°çš„åœ°å€</p>
<p>PatchByte(x, 0x90);æ˜¯æŠŠxæŒ‡å‘çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ç»™nopæ‰</p>
<h2 id="æ•°æ®è¯»å–ä¿®æ”¹"><a href="#æ•°æ®è¯»å–ä¿®æ”¹" class="headerlink" title="æ•°æ®è¯»å–ä¿®æ”¹"></a>æ•°æ®è¯»å–ä¿®æ”¹</h2><h3 id="PatchByte-x2F-Word-x2F-Dword"><a href="#PatchByte-x2F-Word-x2F-Dword" class="headerlink" title="PatchByte&#x2F;Word&#x2F;Dword"></a>PatchByte&#x2F;Word&#x2F;Dword</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">PatchByte</span><span class="params">(<span class="type">long</span> addr , <span class="type">long</span> val)</span> </span><br></pre></td></tr></table></figure>

<p>è®¾ç½®è™šæ‹Ÿåœ°å€addrå¤„çš„ä¸€ä¸ªå­—èŠ‚å€¼ï¼Œ</p>
<p>PatchByteå¯æ›´æ¢ä¸º</p>
<p>PatchWordï¼ŒPatchDword</p>
<p>è®¾ç½®è™šæ‹Ÿåœ°å€addrå¤„çš„2å­—èŠ‚å’Œ4å­—èŠ‚å€¼ã€‚</p>
<h3 id="Byte-x2F-Word-x2F-Dword"><a href="#Byte-x2F-Word-x2F-Dword" class="headerlink" title="Byte&#x2F;Word&#x2F;Dword"></a>Byte&#x2F;Word&#x2F;Dword</h3><p>long Byte( long addr)ï¼Œä»è™šæ‹Ÿåœ°å€ addrå¤„è¯»å–ä¸€ä¸ªå­—èŠ‚å€¼ã€‚</p>
<p>long word(long addr)ï¼Œä»è™šæ‹Ÿåœ°å€addrå¤„è¯»å–ä¸€ä¸ªå­—ï¼ˆ2å­—èŠ‚ï¼‰å€¼ã€‚</p>
<p>1ong Dword(long addr)ï¼Œä»è™šæ‹Ÿåœ°å€addrå¤„è¯»å–ä¸€ä¸ªåŒå­—ï¼ˆ4å­—èŠ‚)å€¼ã€‚</p>
<h3 id="isLoaded"><a href="#isLoaded" class="headerlink" title="isLoaded"></a>isLoaded</h3><p>boo1 isLoaded(long addr)ï¼Œå¦‚æœaddråŒ…å«æœ‰æ•ˆæ•°æ®ï¼Œåˆ™è¿”å›1ï¼Œå¦åˆ™è¿”å›0ã€‚</p>
<p>5ï¼‰long atolï¼ˆstring valï¼‰ï¼Œå°†10è¿›åˆ¶valè½¬åŒ–æˆå¯¹åº”æ•´æ•°å€¼ã€‚</p>
<p>6ï¼‰long xtolï¼ˆstring valï¼‰ï¼Œå°†16è¿›åˆ¶valè½¬åŒ–æˆå¯¹åº”æ•´æ•°å€¼ã€‚</p>
<p>7ï¼‰long ordï¼ˆstring chï¼‰ï¼Œè¿”å›å•å­—ç¬¦å­—ç¬¦ä¸²chçš„ASCIIå€¼ã€‚</p>
<p>8ï¼‰string Nameï¼ˆlong addrï¼‰ï¼Œè¿”å›ä¸ç»™å®šåœ°å€æœ‰å…³çš„åç§°ï¼Œå¦‚æœè¯¥ä½ç½®æ²¡æœ‰åç§°ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚</p>
<h2 id="ç”¨æˆ·äº¤äº’å‡½æ•°"><a href="#ç”¨æˆ·äº¤äº’å‡½æ•°" class="headerlink" title="ç”¨æˆ·äº¤äº’å‡½æ•°"></a>ç”¨æˆ·äº¤äº’å‡½æ•°</h2><h3 id="Message"><a href="#Message" class="headerlink" title="Message"></a>Message</h3><p>void Message(string formatâ€¦.)ï¼Œ</p>
<p>åœ¨è¾“å‡ºçª—å£æ‰“å°ä¸€æ¡æ ¼å¼åŒ–æ¶ˆæ¯ã€‚è¿™ä¸ªå‡½æ•°ç±»ä¼¼äºCè¯­è¨€çš„printfå‡½æ•°ï¼Œå¹¶æ¥å—printfé£æ ¼çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚</p>
<h3 id="print"><a href="#print" class="headerlink" title="print"></a>print</h3><p>void print( . ..)ï¼Œ</p>
<p>åœ¨è¾“å‡ºçª—å£ä¸­æ‰“å°æ¯ä¸ªå‚æ•°çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚</p>
<h3 id="warning"><a href="#warning" class="headerlink" title="warning"></a>warning</h3><p>void warning(string format. â€¦)ï¼Œ</p>
<p>åœ¨å¯¹è¯æ¡†ä¸­æ˜¾ç¤ºä¸€æ¡æ ¼å¼åŒ–æ¶ˆæ¯ã€‚</p>
<h3 id="AskStr"><a href="#AskStr" class="headerlink" title="AskStr"></a>AskStr</h3><p>string AskStr(string default, string prompt)ï¼Œ</p>
<p>æ˜¾ç¤ºä¸€ä¸ªè¾“å…¥æ¡†ï¼Œè¦æ±‚ç”¨æˆ·è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²å€¼ã€‚</p>
<p>å¦‚æœæ“ä½œæˆåŠŸï¼Œåˆ™è¿”å›ç”¨æˆ·çš„å­—ç¬¦ä¸²;</p>
<p>å¦‚æœå¯¹è¯æ¡†è¢«å–æ¶ˆï¼Œåˆ™è¿”å›0ã€‚</p>
<h3 id="AskFile"><a href="#AskFile" class="headerlink" title="AskFile"></a>AskFile</h3><p>string AskFile(1ong doSaveï¼Œstring mask,string prompt)ï¼Œ</p>
<p>æ˜¾ç¤ºä¸€ä¸ªæ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†ï¼Œä»¥ç®€åŒ–é€‰æ‹©æ–‡ä»¶çš„ä»»åŠ¡ã€‚</p>
<p>ä½ å¯ä»¥åˆ›å»ºæ–°æ–‡ä»¶ä¿å­˜æ•°æ®( doSave&#x3D;1)ï¼Œæˆ–é€‰æ‹©ç°æœ‰çš„æ–‡ä»¶è¯»å–æ•°æ®ï¼ˆ doSave&#x3D;0)ã€‚</p>
<p>ä½ å¯ä»¥æ ¹æ®mask ï¼ˆå¦‚* .<em>æˆ–</em>. idc)è¿‡æ»¤æ˜¾ç¤ºçš„æ–‡ä»¶åˆ—è¡¨ã€‚</p>
<p>å¦‚æœæ“ä½œæˆåŠŸï¼Œåˆ™è¿”å›é€‰å®šæ–‡ä»¶çš„åç§°;</p>
<p>å¦‚æœå¯¹è¯æ¡†è¢«å–æ¶ˆ,åˆ™è¿”å›Oã€‚</p>
<h3 id="AskYN"><a href="#AskYN" class="headerlink" title="AskYN"></a>AskYN</h3><p>long AskYN( long default, string prompt)ï¼Œ</p>
<p>ç”¨ä¸€ä¸ªç­”æ¡ˆä¸ºâ€œæ˜¯â€æˆ–â€œå¦â€çš„é—®é¢˜æç¤ºç”¨æˆ·ï¼Œ</p>
<p>çªå‡ºä¸€ä¸ªé»˜è®¤çš„ç­”æ¡ˆ(1ä¸ºæ˜¯ï¼Œ0ä¸ºå¦ï¼Œ-1ä¸ºå–æ¶ˆ)ã€‚</p>
<p>è¿”å›å€¼æ˜¯ä¸€ä¸ªè¡¨ç¤ºé€‰å®šç­”æ¡ˆçš„æ•´æ•°ã€‚</p>
<h3 id="ScreenEA"><a href="#ScreenEA" class="headerlink" title="ScreenEA"></a>ScreenEA</h3><p>long ScreenEA(),</p>
<p>è¿”å›å½“å‰å…‰æ ‡æ‰€åœ¨ä½ç½®çš„è™šæ‹Ÿåœ°å€</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt; idc&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">auto</span> CurrAddress = ScreenEA(); </span><br><span class="line">    <span class="comment">//ScreenEA() è¿”å›å½“å‰å…‰æ ‡æ‰€åœ¨çš„è™šæ‹Ÿåœ°å€</span></span><br><span class="line">     Message(<span class="string">&quot;ç¨‹åºOEP =&gt; 0x%x \n&quot;</span>,CurrAddress);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="Jump"><a href="#Jump" class="headerlink" title="Jump"></a>Jump</h3><p>boo1 Jump( 1ong addr)ï¼Œè·³è½¬åˆ°åæ±‡ç¼–çª—å£çš„æŒ‡å®šåœ°å€ã€‚</p>
<p>å› ä¸ºIDCæ²¡æœ‰ä»»ä½•è°ƒè¯•å·¥å…·ï¼Œä½ å¯èƒ½éœ€è¦å°†Message å‡½æ•°ä½œä¸ºä½ çš„ä¸»è¦è°ƒè¯•å·¥å…·ã€‚</p>
<p>å…¶ä»–å‡ ä¸ªAskXXXå‡½æ•°ç”¨äºå¤„ç†æ›´åŠ ä¸“ç”¨çš„è¾“äººï¼Œå¦‚æ•´æ•°è¾“äººã€‚è¯·å‚è€ƒå¸®åŠ©ç³»ç»Ÿæ–‡æ¡£äº†è§£å¯ç”¨çš„ AskXXXå‡½æ•°çš„å®Œæ•´åˆ—è¡¨ã€‚</p>
<p>å¦‚æœå¸Œæœ›åˆ›å»ºä¸€ä¸ªæ ¹æ®å…‰æ ‡ä½ç½®è°ƒæ•´å…¶è¡Œä¸ºçš„è„šæœ¬ï¼Œè¿™æ—¶ï¼ŒScreenEAå‡½æ•°å°±éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºä½ å¯ä»¥é€šè¿‡å®ƒç¡®å®šå…‰æ ‡çš„å½“å‰ä½ç½®ã€‚</p>
<p>åŒæ ·ï¼Œå¦‚æœä½ çš„è„šæœ¬éœ€è¦å°†ç”¨æˆ·çš„æ³¨æ„åŠ›è½¬ç§»åˆ°åæ±‡ç¼–ä»£ç æ¸…å•ä¸­çš„æŸä¸ªä½ç½®ï¼Œä¹Ÿéœ€è¦ç”¨åˆ°Jumpå‡½æ•°ã€‚</p>
<h2 id="å­—ç¬¦ä¸²æ“ä½œå‡½æ•°"><a href="#å­—ç¬¦ä¸²æ“ä½œå‡½æ•°" class="headerlink" title="å­—ç¬¦ä¸²æ“ä½œå‡½æ•°"></a>å­—ç¬¦ä¸²æ“ä½œå‡½æ•°</h2><h3 id="form"><a href="#form" class="headerlink" title="form"></a>form</h3><p>string form(string formatï¼Œâ€¦)</p>
<p>&#x2F;&#x2F;preIDA5.6ï¼Œè¿”å›ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²æ ¹æ®æ‰€æä¾›çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²å’Œå€¼è¿›è¡Œæ ¼å¼åŒ–ã€‚è¿™ä¸ªå‡½æ•°åŸºæœ¬ä¸Šç­‰åŒäºCè¯­è¨€çš„sprintfå‡½æ•°</p>
<h3 id="sprintf"><a href="#sprintf" class="headerlink" title="sprintf"></a>sprintf</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> <span class="title function_">sprintf</span><span class="params">(<span class="built_in">string</span> format . . . .)</span></span><br></pre></td></tr></table></figure>

<p>&#x2F;&#x2F;IDA5.6+ï¼Œåœ¨ IDA5.6ä¸­ï¼Œsprintfç”¨äºæ›¿ä»£form(å‚è§ä¸Šé¢)ã€‚</p>
<h3 id="atol"><a href="#atol" class="headerlink" title="atol"></a>atol</h3><p>1ong ato1(string va1)ï¼Œå°†åè¿›åˆ¶å€¼va1è½¬æ¢æˆå¯¹åº”çš„æ•´æ•°å€¼ã€‚</p>
<h3 id="xtol"><a href="#xtol" class="headerlink" title="xtol"></a>xtol</h3><p>1ong xtol(string val)ï¼Œå°†åå…­è¿›åˆ¶å€¼val(å¯é€‰æ‹©ä»¥0xå¼€å¤´ï¼‰è½¬æ¢æˆå¯¹åº”çš„æ•´æ•°å€¼ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Message(&quot;åå…­è¿›åˆ¶è½¬ä¸ºæ•´æ•°: %d \n&quot;,xtol(&quot;0x41&quot;))</span><br></pre></td></tr></table></figure>



<h3 id="ltoa"><a href="#ltoa" class="headerlink" title="ltoa"></a>ltoa</h3><p>string ltoa(1ong va1ï¼Œ1ong radix)ï¼Œ</p>
<p>ä»¥æŒ‡å®šçš„radix (2ã€8ã€10æˆ–16)è¿”å›va1çš„å­—ç¬¦ä¸²å€¼ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Message(&quot;åè¿›åˆ¶100è½¬ä¸ºå…«è¿›åˆ¶: %d \n&quot;,ltoa(100,8));</span><br></pre></td></tr></table></figure>



<h3 id="ord"><a href="#ord" class="headerlink" title="ord"></a>ord</h3><p>long ord(string ch)ï¼Œè¿”å›å•å­—ç¬¦å­—ç¬¦ä¸²ch çš„ASCIå€¼ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Message(&quot;å­—ç¬¦Açš„ASCII: %d \n&quot;,ord(&quot;A&quot;));</span><br></pre></td></tr></table></figure>



<h3 id="strlen"><a href="#strlen" class="headerlink" title="strlen"></a>strlen</h3><p>long strlen(string str)ï¼Œè¿”å›æ‰€æä¾›å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Message(&quot;è®¡ç®—å­—ç¬¦ä¸²é•¿åº¦: %d \n&quot;,strlen(&quot;hello re4mile&quot;));</span><br></pre></td></tr></table></figure>



<h3 id="strstr"><a href="#strstr" class="headerlink" title="strstr"></a>strstr</h3><p>long strstr(string str. string substr)ï¼Œ</p>
<p>è¿”å›strä¸­ substr çš„ç´¢å¼•ã€‚</p>
<p>å¦‚æœæ²¡æœ‰å‘ç°å­å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å›-1ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="built_in">strstr</span>(op,<span class="string">&quot;push    esi&quot;</span>)==<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br><span class="line">å…¶å®ä»–å°±æ˜¯ä¸€ä¸ª<span class="built_in">strcmp</span>çš„ä½œç”¨,å¦‚æœè¿”å›<span class="number">0</span>,è¯´æ˜å­—ç¬¦ä¸²åˆšå¥½åŒ¹é…</span><br></pre></td></tr></table></figure>



<h3 id="substr"><a href="#substr" class="headerlink" title="substr"></a>substr</h3><p>string substr(string str. long start.1ong end)ï¼Œ</p>
<p>è¿”å›åŒ…å« str ä¸­ç”±startåˆ°end-1ä½ç½®çš„å­—ç¬¦çš„å­å­—ç¬¦ä¸²ã€‚</p>
<p>å¦‚æœä½¿ç”¨åˆ†ç‰‡ï¼ˆIDA5.6åŠæ›´é«˜ç‰ˆæœ¬)ï¼Œæ­¤å‡½æ•°ç­‰åŒäºstr[start:end]ã€‚<br>å¦‚å‰æ‰€è¿°ï¼ŒIDCä¸­æ²¡æœ‰ä»»ä½•å­—ç¬¦æ•°æ®ç±»å‹ï¼Œå®ƒä¹Ÿä¸æ”¯æŒä»»ä½•æ•°ç»„è¯­æ³•ã€‚</p>
<p>å¦‚æœä½ æƒ³è¦éå†å­—ç¬¦ä¸²çš„æ¯ä¸ªå­—ç¬¦ï¼Œå¿…é¡»æŠŠå­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå­—ç¬¦å½“æˆè¿ç»­çš„å•å­—ç¬¦å­å­—ç¬¦ä¸²å¤„ç†ã€‚</p>
<h2 id="æ–‡ä»¶æ“ä½œ"><a href="#æ–‡ä»¶æ“ä½œ" class="headerlink" title="æ–‡ä»¶æ“ä½œ"></a>æ–‡ä»¶æ“ä½œ</h2><p>è¾“å‡ºçª—å£å¹¶ä¸æ€»æ˜¯æ˜¾ç¤ºè„šæœ¬è¾“å‡ºçš„ç†æƒ³ä½ç½®</p>
<p>å¯¹äºç”Ÿæˆå¤§é‡æ–‡æœ¬æˆ–äºŒè¿›åˆ¶æ•°æ®çš„è„šæœ¬ï¼Œä½ å¯èƒ½å¸Œæœ›å°†å…¶ç»“æœè¾“å‡ºåˆ°ç£ç›˜æ–‡ä»¶ä¸Šã€‚</p>
<p>æˆ‘ä»¬å·²ç»è®¨è®ºäº†å¦‚ä½•ä½¿ç”¨AskFi1eå‡½æ•°è¦æ±‚ç”¨æˆ·è¾“å…¥æ–‡ä»¶åã€‚</p>
<p>ä½†æ˜¯ï¼ŒAskFi1eä»…è¿”å›ä¸€ä¸ªåŒ…å«æ–‡ä»¶åçš„å­—ç¬¦ä¸²å€¼ã€‚</p>
<p>IDCçš„æ–‡ä»¶å¤„ç†å‡½æ•°å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<h3 id="fopen"><a href="#fopen" class="headerlink" title="fopen"></a>fopen</h3><p>long fopen(string filenameï¼Œstring mode)</p>
<p>è¿”å›ä¸€ä¸ªæ•´æ•°æ–‡ä»¶å¥æŸ„ï¼ˆå¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œåˆ™è¿”å›0)</p>
<p>ä¾›æ‰€æœ‰IDCæ–‡ä»¶è¾“å…¥&#x2F;è¾“å‡ºå‡½æ•°ä½¿ç”¨</p>
<p>modeå‚æ•°ä¸Cè¯­è¨€çš„fopen å‡½æ•°ä½¿ç”¨çš„æ¨¡å¼( rè¡¨ç¤ºè¯»å–ï¼Œwè¡¨ç¤ºå†™å…¥ï¼Œç­‰ç­‰ï¼‰ç±»ä¼¼</p>
<h3 id="fclose"><a href="#fclose" class="headerlink" title="fclose"></a>fclose</h3><p>void fclose(long hand1e)</p>
<p>å…³é—­fopenä¸­æ–‡ä»¶å¥æŸ„æŒ‡å®šçš„æ–‡ä»¶ã€‚</p>
<h3 id="filelength"><a href="#filelength" class="headerlink" title="filelength"></a>filelength</h3><p>long filelength(long handle)</p>
<p>è¿”å›æŒ‡å®šæ–‡ä»¶çš„é•¿åº¦ï¼Œ</p>
<p>å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œåˆ™è¿”å›-1ã€‚</p>
<h3 id="fgetc"><a href="#fgetc" class="headerlink" title="fgetc"></a>fgetc</h3><p>1ong fgetc(long handle)ï¼Œä»ç»™å®šæ–‡ä»¶ä¸­è¯»å–ä¸€ä¸ªå­—èŠ‚</p>
<p>å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œåˆ™è¿”å›-1ã€‚</p>
<h3 id="fputc"><a href="#fputc" class="headerlink" title="fputc"></a>fputc</h3><p>long fputc(long val. long handle)ï¼Œå†™å…¥ä¸€ä¸ªå­—èŠ‚åˆ°ç»™å®šæ–‡ä»¶ä¸­</p>
<p>å¦‚æœæ“ä½œæˆåŠŸï¼Œåˆ™è¿”å›0;</p>
<p>å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œåˆ™è¿”å›-1ã€‚</p>
<h3 id="fprintf"><a href="#fprintf" class="headerlink" title="fprintf"></a>fprintf</h3><p>long fprintf(1ong handle, string formatï¼Œâ€¦)</p>
<p>å°†ä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²å†™å…¥åˆ°ç»™å®šæ–‡ä»¶ä¸­ã€‚</p>
<h3 id="writestr"><a href="#writestr" class="headerlink" title="writestr"></a>writestr</h3><p>long writestr(long handle. string str)ï¼Œå°†æŒ‡å®šçš„å­—ç¬¦ä¸²å†™å…¥åˆ°ç»™å®šæ–‡ä»¶ä¸­ã€‚</p>
<h3 id="readstr"><a href="#readstr" class="headerlink" title="readstr"></a>readstr</h3><p>string&#x2F;long readstr(1ong handle)ï¼Œä»ç»™å®šæ–‡ä»¶ä¸­è¯»å–ä¸€ä¸ªå­—ç¬¦ä¸²</p>
<p>è¿™ä¸ªå‡½æ•°è¯»å–åˆ°ä¸‹ä¸€ä¸ªæ¢è¡Œç¬¦ä¸ºæ­¢çš„æ‰€æœ‰å­—ç¬¦ï¼ˆåŒ…æ‹¬éASCIIå­—ç¬¦)ï¼ŒåŒ…æ‹¬æ¢è¡Œç¬¦æœ¬èº«(ASCII OxA )ã€‚</p>
<p>å¦‚æœæ“ä½œæˆåŠŸï¼Œåˆ™è¿”å›å­—ç¬¦ä¸²;</p>
<p>å¦‚æœè¯»å–åˆ°æ–‡ä»¶ç»“å°¾ï¼Œåˆ™è¿”å›-1ã€‚</p>
<h3 id="writelong"><a href="#writelong" class="headerlink" title="writelong"></a>writelong</h3><p>long writelong(long handle. long va1ï¼Œ long bigendian)</p>
<p>ä½¿ç”¨å¤§ç«¯(bigendian-1)æˆ–å°ç«¯( bigendian&#x3D;0)å­—èŠ‚é¡ºåºå°†ä¸€ä¸ª4å­—èŠ‚æ•´æ•°å†™å…¥åˆ°ç»™å®šæ–‡ä»¶ã€‚</p>
<h3 id="readlong"><a href="#readlong" class="headerlink" title="readlong"></a>readlong</h3><p>long readlong( long handle,long bigendian)</p>
<p>ä½¿ç”¨å¤§ç«¯(bigendian&#x3D;1)</p>
<p>æˆ–å°ç«¯( bigendian&#x3D;-Q)å­—èŠ‚é¡ºåºä»ç»™å®šçš„æ–‡ä»¶ä¸­è¯»å–ä¸€ä¸ª4å­—èŠ‚æ•´æ•°ã€‚</p>
<h3 id="writeshort"><a href="#writeshort" class="headerlink" title="writeshort"></a>writeshort</h3><p>long writeshort(long handleï¼Œlong va1,long bigendian)</p>
<p>ä½¿ç”¨å¤§ç«¯( bigendian&#x3D;1)æˆ–å°ç«¯( bigendian&#x3D;0)å­—èŠ‚é¡ºåºå°†ä¸€ä¸ª2å­—èŠ‚æ•´æ•°å†™å…¥åˆ°ç»™å®šçš„æ–‡ä»¶ã€‚</p>
<h3 id="readshort"><a href="#readshort" class="headerlink" title="readshort"></a>readshort</h3><p>long readshort( 1ong handle,long bigendian)</p>
<p>ä½¿ç”¨å¤§ç«¯(bigendian-1)æˆ–å°ç«¯( bigendian&#x3D;0)å­—èŠ‚é¡ºåºä»ç»™å®šçš„æ–‡ä»¶ä¸­è¯»å–ä¸€ä¸ª2å­—èŠ‚æ•´æ•°ã€‚</p>
<h3 id="loadfile"><a href="#loadfile" class="headerlink" title="loadfile"></a>loadfile</h3><p>bool loadfile(long handle.long posï¼Œlong addr. long length)</p>
<p>ä»ç»™å®šæ–‡ä»¶çš„posä½ç½®è¯»å–lengthæ•°é‡çš„å­—èŠ‚ï¼Œå¹¶å°†è¿™äº›å­—èŠ‚å†™å…¥åˆ°ä»¥addråœ°å€å¼€å¤´çš„æ•°æ®åº“ä¸­ã€‚</p>
<h3 id="savefile"><a href="#savefile" class="headerlink" title="savefile"></a>savefile</h3><p>bool savefile(long handleï¼Œ1ong pos.long addr. long length)</p>
<p>å°†ä»¥addræ•°æ®åº“åœ°å€å¼€å¤´çš„lengthæ•°é‡çš„å­—èŠ‚å†™å…¥ç»™å®šæ–‡ä»¶çš„posä½ç½®ã€‚</p>
<p>eg</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;idc.idc&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="title function_">getFuncName</span><span class="params">(ea)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">auto</span> funcName = get_func_name(ea);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> dm = demangle_name(funcName, get_inf_attr(INF_LONG_DN));</span><br><span class="line">    <span class="keyword">if</span> (dm != <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        funcName = dm;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> funcName;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="title function_">functionDump</span><span class="params">(ip_CurFuncStart)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">auto</span> funcName = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">auto</span> ip_CurFuncEnd = <span class="number">0x0</span>;</span><br><span class="line">    <span class="keyword">auto</span> ip_NextFuncStart;</span><br><span class="line">    <span class="keyword">auto</span> sz_FileName = get_idb_path()[<span class="number">0</span>:<span class="number">-4</span>] + <span class="string">&quot;_dump.txt&quot;</span>;</span><br><span class="line">    <span class="keyword">auto</span> fp = fopen(sz_FileName, <span class="string">&quot;w&quot;</span>);</span><br><span class="line">    <span class="keyword">auto</span> appendData = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (ip_CurFuncStart != BADADDR)</span><br><span class="line">    &#123;</span><br><span class="line">        ip_CurFuncStart     = NextFunction(ip_CurFuncStart);</span><br><span class="line">		ip_CurFuncEnd       = FindFuncEnd(ip_CurFuncStart);</span><br><span class="line">        ip_NextFuncStart    = NextFunction(ip_CurFuncStart);</span><br><span class="line">        funcName            = getFuncName(ip_CurFuncStart);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (ip_NextFuncStart == BADADDR)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">fprintf</span>(fp, <span class="string">&quot;0x%08X --&gt; 0x%08X %s\n&quot;</span>, ip_CurFuncStart, ip_CurFuncEnd, funcName);</span><br><span class="line">            ip_CurFuncStart = ip_NextFuncStart;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        appendData = ip_NextFuncStart - ip_CurFuncEnd;</span><br><span class="line">       <span class="comment">// ip_CurFuncEnd = ip_NextFuncStart - 1;//ä»–ä»¬ä¹‹é—´çš„å·®åˆ«ä¸ä»…ä»…æ˜¯1,å› ä¸ºä¼šæœ‰å­—èŠ‚çš„å¡«å……</span></span><br><span class="line">        <span class="built_in">fprintf</span>(fp, <span class="string">&quot;0x%08X --&gt; 0x%08X + 0x%08X %s\n&quot;</span>, ip_CurFuncStart, ip_CurFuncEnd, appendData,funcName);</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(fp);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	Message(<span class="string">&quot;Start\n&quot;</span>);</span><br><span class="line">    functionDump(<span class="number">0x00040000</span>);</span><br><span class="line">	Message(<span class="string">&quot;End\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="æ“ä½œæ•°æ®åº“åç§°"><a href="#æ“ä½œæ•°æ®åº“åç§°" class="headerlink" title="æ“ä½œæ•°æ®åº“åç§°"></a>æ“ä½œæ•°æ®åº“åç§°</h2><p>åœ¨è„šæœ¬ä¸­ï¼Œä½ ç»å¸¸éœ€è¦æ“çºµå·²å‘½åçš„ä½ç½®ã€‚ä¸‹é¢çš„IDCå‡½æ•°ç”¨äºå¤„ç†IDAæ•°æ®åº“ä¸­å·²å‘½åçš„ä½ç½®ã€‚</p>
<h3 id="Name"><a href="#Name" class="headerlink" title="Name"></a>Name</h3><p>string Name(1ong addr)ï¼Œ</p>
<p>è¿”å›ä¸ç»™å®šåœ°å€æœ‰å…³çš„åç§°ï¼Œ</p>
<p>å¦‚æœè¯¥ä½ç½®æ²¡æœ‰åç§°ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚</p>
<p>å¦‚æœåç§°è¢«æ ‡è®°ä¸ºå±€éƒ¨åç§°ï¼Œè¿™ä¸ªå‡½æ•°å¹¶ä¸è¿”å›ç”¨æˆ·å®šä¹‰çš„åç§°ã€‚</p>
<h3 id="NameEx"><a href="#NameEx" class="headerlink" title="NameEx"></a>NameEx</h3><p>string NameEx(long fromï¼Œlong addr)ï¼Œè¿”å›ä¸addræœ‰å…³çš„åç§°ã€‚å¦‚æœè¯¥ä½ç½®æ²¡æœ‰åç§°ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚</p>
<p>å¦‚æœ fromæ˜¯ä¸€ä¸ªåŒæ ·åŒ…å«addrçš„å‡½æ•°ä¸­çš„åœ°å€ï¼Œåˆ™è¿™ä¸ªå‡½æ•°è¿”å›ç”¨æˆ·å®šä¹‰çš„å±€éƒ¨åç§°ã€‚</p>
<h3 id="MakeNameEx"><a href="#MakeNameEx" class="headerlink" title="MakeNameEx"></a>MakeNameEx</h3><p>bool MakeNameEx(1ong addr. string name. long flags)ï¼Œ</p>
<p>å°†ç»™å®šçš„åç§°åˆ†é…ç»™ç»™å®šçš„åœ°å€ã€‚è¯¥åç§°ä½¿ç”¨flagsä½æ©ç ä¸­æŒ‡å®šçš„å±æ€§åˆ›å»ºè€Œæˆã€‚</p>
<p>è¿™äº›æ ‡å¿—åœ¨å¸®åŠ©ç³»ç»Ÿä¸­çš„MakeNameExæ–‡æ¡£ä¸­æœ‰è®°è½½æè¿°ï¼Œ</p>
<p>å¯ç”¨äºæŒ‡å®šå„ç§å±æ€§ï¼Œå¦‚åç§°æ˜¯å±€éƒ¨åç§°è¿˜æ˜¯å…¬å…±åç§°ã€åç§°æ˜¯å¦åº”åœ¨åç§°çª—å£ä¸­åˆ—å‡º</p>
<h3 id="LocByName"><a href="#LocByName" class="headerlink" title="LocByName"></a>LocByName</h3><p>long LocByName(string name)ï¼Œè¿”å›ä¸€ä¸ªä½ç½®ï¼ˆåç§°å·²ç»™å®šï¼‰çš„åœ°å€ã€‚å¦‚æœæ•°æ®åº“ä¸­æ²¡æœ‰è¿™ä¸ªåç§°ï¼Œåˆ™è¿”å›BADADDR ( -1 )ã€‚</p>
<h3 id="LocByNameEx"><a href="#LocByNameEx" class="headerlink" title="LocByNameEx"></a>LocByNameEx</h3><p>long LocByNameEx(long funcaddrï¼Œ string loca 1name)ï¼Œåœ¨åŒ…å«funcaddrçš„å‡½æ•°ä¸­æœç´¢ç»™å®šçš„å±€éƒ¨åç§°ã€‚å¦‚æœç»™å®šçš„å‡½æ•°ä¸­æ²¡æœ‰è¿™ä¸ªåç§°ï¼Œåˆ™è¿”å›BADADDR ( -1 )o</p>
<h2 id="æ“ä½œæ•°æ®åº“çš„å‡½æ•°"><a href="#æ“ä½œæ•°æ®åº“çš„å‡½æ•°" class="headerlink" title="æ“ä½œæ•°æ®åº“çš„å‡½æ•°"></a>æ“ä½œæ•°æ®åº“çš„å‡½æ•°</h2><p>æœ‰å¤§é‡å‡½æ•°å¯ç”¨äºå¯¹æ•°æ®åº“çš„å†…å®¹è¿›è¡Œæ ¼å¼åŒ–ã€‚è¿™äº›å‡½æ•°å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<h3 id="MakeUnkn"><a href="#MakeUnkn" class="headerlink" title="MakeUnkn"></a>MakeUnkn</h3><p>void MakeUnkn(long addr. long flags)ï¼Œ</p>
<p>å–æ¶ˆä½äºæŒ‡å®šåœ°å€çš„é¡¹çš„å®šä¹‰ã€‚</p>
<p>è¿™é‡Œçš„æ ‡å¿—(å‚è§IDCçš„MakeUnknæ–‡æ¡£ï¼‰æŒ‡å‡ºæ˜¯å¦ä¹Ÿå–æ¶ˆéšåçš„é¡¹çš„å®šä¹‰</p>
<p>ä»¥åŠæ˜¯å¦åˆ é™¤ä»»ä½•ä¸å–æ¶ˆå®šä¹‰çš„é¡¹æœ‰å…³çš„åç§°ã€‚</p>
<p>ç›¸å…³å‡½æ•°MakeUnknown å…è®¸ä½ å–æ¶ˆå¤§å—æ•°æ®çš„å®šä¹‰ã€‚</p>
<h3 id="MakeCode"><a href="#MakeCode" class="headerlink" title="MakeCode"></a>MakeCode</h3><p>long MakeCode(1ong addr)ï¼Œ</p>
<p>å°†ä½äºæŒ‡å®šåœ°å€çš„å­—èŠ‚è½¬æ¢æˆä¸€æ¡æŒ‡ä»¤ã€‚</p>
<p>å¦‚æœæ“ä½œæˆåŠŸï¼Œåˆ™è¿”å›æŒ‡ä»¤çš„é•¿åº¦ï¼Œ</p>
<p>å¦åˆ™è¿”å›0ã€‚</p>
<h3 id="MakeByte"><a href="#MakeByte" class="headerlink" title="MakeByte"></a>MakeByte</h3><p>bool MakeByte(long addr)ï¼Œ</p>
<p>å°†ä½äºæŒ‡å®šåœ°å€çš„é¡¹ç›®è½¬æ¢æˆä¸€ä¸ªæ•°æ®å­—èŠ‚ã€‚</p>
<p>ç±»ä¼¼çš„å‡½æ•°è¿˜åŒ…æ‹¬Makewordå’Œ MakeDwordã€‚</p>
<h3 id="MakeComm"><a href="#MakeComm" class="headerlink" title="MakeComm"></a>MakeComm</h3><p>boo1 MakeComm(long addr. string comment)ï¼Œ</p>
<p>åœ¨ç»™å®šçš„åœ°å€å¤„æ·»åŠ ä¸€æ¡å¸¸è§„æ³¨é‡Šã€‚</p>
<h3 id="MakeFunction"><a href="#MakeFunction" class="headerlink" title="MakeFunction"></a>MakeFunction</h3><p>bool MakeFunction(long beginï¼Œlong end)ï¼Œ</p>
<p>å°†ç”±beginåˆ°end çš„æŒ‡ä»¤è½¬æ¢æˆä¸€ä¸ªå‡½æ•°ã€‚å¦‚æœendè¢«æŒ‡å®šä¸ºBADADDR ( -1)ï¼ŒIDAä¼šå°è¯•é€šè¿‡å®šä½å‡½æ•°çš„è¿”å›æŒ‡ä»¤ï¼Œæ¥è‡ªåŠ¨ç¡®å®šè¯¥å‡½æ•°çš„ç»“æŸåœ°å€ã€‚</p>
<h3 id="MakeStr"><a href="#MakeStr" class="headerlink" title="MakeStr"></a>MakeStr</h3><p>bool MakeStr(1ong beginï¼Œlong end)ï¼Œ</p>
<p>åˆ›å»ºä¸€ä¸ªå½“å‰å­—ç¬¦ä¸²(ç”±GetStringTypeè¿”å›)ç±»å‹çš„å­—ç¬¦ä¸²,</p>
<p>æ¶µç›–ç”±beginåˆ°end-1ä¹‹é—´çš„æ‰€æœ‰å­—èŠ‚ã€‚</p>
<p>å¦‚æœendè¢«æŒ‡å®šä¸ºBADADDR,IDAä¼šå°è¯•è‡ªåŠ¨ç¡®å®šå­—ç¬¦ä¸²çš„ç»“æŸä½ç½®ã€‚</p>
<h2 id="æ•°æ®åº“æœç´¢å‡½æ•°"><a href="#æ•°æ®åº“æœç´¢å‡½æ•°" class="headerlink" title="æ•°æ®åº“æœç´¢å‡½æ•°"></a>æ•°æ®åº“æœç´¢å‡½æ•°</h2><p>åœ¨IDCä¸­ï¼ŒIDAçš„ç»å¤§éƒ¨åˆ†æœç´¢åŠŸèƒ½å¯é€šè¿‡å„ç§FindXXXå‡½æ•°æ¥å®ç°ï¼Œä¸‹é¢æˆ‘ä»¬å°†ä»‹ç»å…¶ä¸­ä¸€äº›å‡½æ•°ã€‚FindXXXå‡½æ•°ä¸­çš„flagså‚æ•°æ˜¯ä¸€ä¸ªä½æ©ç ï¼Œå¯ç”¨äºæŒ‡å®šæŸ¥æ‰¾æ“ä½œçš„è¡Œä¸ºã€‚3ä¸ªæœ€ä¸ºå¸¸ç”¨çš„æ ‡å¿—åˆ†åˆ«ä¸ºSEARCH_DOWNï¼Œå®ƒæŒ‡ç¤ºæœç´¢æ“ä½œæ‰«æé«˜ä½åœ°å€;SEARCH_NEXTï¼Œå®ƒç•¥è¿‡å½“å‰åŒ¹é…é¡¹ï¼Œä»¥æœç´¢ä¸‹ä¸€ä¸ªåŒ¹é…é¡¹;SEARCH_CASEï¼Œå®ƒä»¥åŒºåˆ†å¤§å°å†™çš„æ–¹å¼è¿›è¡ŒäºŒè¿›åˆ¶å’Œæ–‡æœ¬æœç´¢ã€‚</p>
<h3 id="FindCode"><a href="#FindCode" class="headerlink" title="FindCode"></a>FindCode</h3><p>long FindCode(long addr, long flags)ï¼Œ</p>
<p>ä»ç»™å®šçš„åœ°å€æœç´¢ä¸€æ¡æŒ‡ä»¤ã€‚</p>
<h3 id="FindData"><a href="#FindData" class="headerlink" title="FindData"></a>FindData</h3><p>long FindData(long addr.long flags)ï¼Œä»ç»™å®šçš„åœ°å€æœç´¢ä¸€ä¸ªæ•°æ®é¡¹ã€‚</p>
<h3 id="FindBinary"><a href="#FindBinary" class="headerlink" title="FindBinary"></a>FindBinary</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="title function_">FindBinary</span><span class="params">(<span class="type">long</span> addrï¼Œ<span class="type">long</span> flagsï¼Œ<span class="built_in">string</span> binary)</span></span><br></pre></td></tr></table></figure>

<p>ä»ç»™å®šçš„åœ°å€<code>addr</code>æœç´¢16è¿›åˆ¶å­—ç¬¦ä¸²åºåˆ—<code> binary</code></p>
<p>è¿”å›è¯¥å­—èŠ‚ç å‡ºç°çš„åœ°å€</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">flagå–å€¼æœ‰ï¼šå¯é€‰é¡¹</span><br><span class="line"> </span><br><span class="line">SEARCH_DOWN å‘ä¸‹æœç´¢</span><br><span class="line">SEARCH_UP å‘ä¸Šæœç´¢</span><br><span class="line">SEARCH_NEXT è·å–ä¸‹ä¸€ä¸ªæ‰¾åˆ°çš„å¯¹è±¡ã€‚</span><br><span class="line">SEARCH_CASE æŒ‡å®šå¤§å°å†™æ•æ„Ÿåº¦</span><br><span class="line">SEARCH_UNICODE æœç´¢ Unicode å­—ç¬¦ä¸²ã€‚</span><br></pre></td></tr></table></figure>



<h3 id="FindText"><a href="#FindText" class="headerlink" title="FindText"></a>FindText</h3><p>long FindText(long addr.long flags.1ong row.long columnï¼Œstring text)ï¼Œ</p>
<p>åœ¨ç»™å®šçš„åœ°å€ï¼Œä»ç»™å®šè¡Œ( row)çš„ç»™å®šåˆ—æœç´¢å­—ç¬¦ä¸²textã€‚æ³¨æ„ï¼ŒæŸä¸ªç»™å®šåœ°å€çš„åæ±‡ç¼–æ–‡æœ¬.å¯èƒ½ä¼šè·¨è¶Šå‡ è¡Œï¼Œå› æ­¤,ä½ éœ€è¦æŒ‡å®šæœç´¢åº”ä»å“ªä¸€è¡Œå¼€å§‹ã€‚<br>è¿˜è¦æ³¨æ„çš„æ˜¯ï¼ŒSEARCH_NEXTå¹¶æœªå®šä¹‰æœç´¢çš„æ–¹å‘ï¼Œæ ¹æ®SEARCH_DOWN æ ‡å¿—ï¼Œå…¶æ–¹å‘å¯èƒ½å‘ä¸Šä¹Ÿå¯èƒ½å‘ä¸‹ã€‚æ­¤å¤–ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®SEARCH_NEXTï¼Œä¸” addrä½ç½®çš„é¡¹ä¸æœç´¢æ¡ä»¶åŒ¹é…ï¼Œåˆ™FindXXXå‡½æ•°å¾ˆå¯èƒ½ä¼šè¿”å›addrå‚æ•°ä¼ é€’ç»™è¯¥å‡½æ•°çš„åœ°å€ã€‚</p>
<h2 id="æ“ä½œå‡½æ•°"><a href="#æ“ä½œå‡½æ•°" class="headerlink" title="æ“ä½œå‡½æ•°"></a>æ“ä½œå‡½æ•°</h2><p>è®¸å¤šè„šæœ¬ä¸“ç”¨äºåˆ†ææ•°æ®åº“ä¸­çš„å‡½æ•°ã€‚</p>
<p>IDAä¸ºç»è¿‡åæ±‡ç¼–çš„å‡½æ•°åˆ†é…å¤§é‡å±æ€§ï¼Œå¦‚å‡½æ•°å±€éƒ¨å˜é‡åŒºåŸŸçš„å¤§å°ã€å‡½æ•°çš„å‚æ•°åœ¨è¿è¡Œæ—¶æ ˆä¸Šçš„å¤§å°ã€‚</p>
<p>ä¸‹é¢çš„IDCå‡½æ•°å¯ç”¨äºè®¿é—®ä¸æ•°æ®åº“ä¸­çš„</p>
<h3 id="GetFunctionAttr"><a href="#GetFunctionAttr" class="headerlink" title="GetFunctionAttr"></a>GetFunctionAttr</h3><p>long GetFunctionAttr(long addr, 1ong attrib)ï¼Œ</p>
<p>è¿”å›åŒ…å«ç»™å®šåœ°å€çš„å‡½æ•°çš„è¢«è¯·æ±‚çš„å±æ€§</p>
<p>ä¾‹å¦‚ï¼Œè¦æŸ¥æ‰¾ä¸€ä¸ªå‡½æ•°çš„ç»“æŸåœ°å€ï¼Œå¯ä»¥ä½¿ç”¨GetFunctionAttr(addr. FUNCATTR_END)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">funcStart = GetFunctionAttr(origEA,FUNCATTR_START);</span><br><span class="line">funcEnd = GetFunctionAttr(origEA,FUNCATTR_END)</span><br></pre></td></tr></table></figure>



<h3 id="GetFunctionName"><a href="#GetFunctionName" class="headerlink" title="GetFunctionName"></a>GetFunctionName</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> <span class="title function_">GetFunctionName</span><span class="params">(<span class="type">long</span> addr)</span></span><br></pre></td></tr></table></figure>

<p>å‚æ•°æ˜¯ä¸€ä¸ªæŒ‡ä»¤çš„åœ°å€</p>
<p>è¿”å›å½“å‰æŒ‡ä»¤å±äºå“ªä¸ªå‡½æ•°</p>
<p>å¦‚æœç»™å®šçš„åœ°å€å¹¶ä¸å±äºä¸€ä¸ªå‡½æ•°ï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºæ ¼å­—ç¬¦ä¸²â€ â€œ</p>
<h3 id="NextFunction"><a href="#NextFunction" class="headerlink" title="NextFunction"></a>NextFunction</h3><p>auto NextFunction(auto addr)ï¼Œ</p>
<p>è¿”å›ç»™å®šåœ°å€åçš„ä¸‹ä¸€ä¸ªå‡½æ•°çš„èµ·å§‹åœ°å€ã€‚</p>
<p>å¦‚æœæ•°æ®åº“ä¸­ç»™å®šåœ°å€åæ²¡æœ‰å…¶ä»–å‡½æ•°ï¼Œåˆ™è¿”å›-1ã€‚</p>
<h3 id="PrevFunction"><a href="#PrevFunction" class="headerlink" title="PrevFunction"></a>PrevFunction</h3><p>1ong PrevFunction(1ong addr)ï¼Œ</p>
<p>è¿”å›ç»™å®šåœ°å€ä¹‹å‰è·ç¦»æœ€è¿‘çš„å‡½æ•°çš„èµ·å§‹åœ°å€ã€‚</p>
<p>å¦‚æœåœ¨ç»™å®šåœ°å€ä¹‹å‰æ²¡æœ‰å‡½æ•°ï¼Œåˆ™è¿”å›-1ã€‚</p>
<p>æ ¹æ®å‡½æ•°çš„åç§°ï¼Œä½¿ç”¨LocByNameå‡½æ•°æŸ¥æ‰¾è¯¥å‡½æ•°çš„èµ·å§‹åœ°å€ã€‚</p>
<h2 id="ä»£ç äº¤å‰å¼•ç”¨å‡½æ•°"><a href="#ä»£ç äº¤å‰å¼•ç”¨å‡½æ•°" class="headerlink" title="ä»£ç äº¤å‰å¼•ç”¨å‡½æ•°"></a>ä»£ç äº¤å‰å¼•ç”¨å‡½æ•°</h2><h3 id="Rfirst"><a href="#Rfirst" class="headerlink" title="Rfirst"></a>Rfirst</h3><p>long Rfirst(long from)ï¼Œ</p>
<p>è¿”å›ç»™å®šåœ°å€å‘å…¶è½¬äº¤æ§åˆ¶æƒçš„ç¬¬â€“ä¸ªä½ç½®ã€‚</p>
<p>å¦‚æœç»™å®šçš„åœ°å€æ²¡æœ‰å¼•ç”¨å…¶ä»–åœ°å€ï¼Œåˆ™è¿”å›BADADDR ( -1 )</p>
<h3 id="Rnext"><a href="#Rnext" class="headerlink" title="Rnext"></a>Rnext</h3><p>long Rnext(1ong fromï¼Œlong current)ï¼Œ</p>
<p>å¦‚æœcurrent å·²ç»åœ¨å‰ä¸€æ¬¡è°ƒç”¨Rfirstæˆ–Rnextæ—¶è¿”å›,</p>
<p>åˆ™è¿”å›ç»™å®šåœ°å€( from )è½¬äº¤æ§åˆ¶æƒçš„ä¸‹ä¸€ä¸ªä½ç½®ã€‚</p>
<p>å¦‚æœæ²¡æœ‰å…¶ä»–äº¤å‰å¼•ç”¨å­˜åœ¨ï¼Œåˆ™è¿”å›BADADDRã€‚</p>
<h3 id="XrefType"><a href="#XrefType" class="headerlink" title="XrefType"></a>XrefType</h3><p>long XrefType()ï¼Œ</p>
<p>è¿”å›-ä¸ªå¸¸é‡ï¼Œè¯´æ˜æŸä¸ªäº¤å‰å¼•ç”¨æŸ¥è¯¢å‡½æ•°ï¼ˆå¦‚Rfirst)</p>
<p>è¿”å›çš„æœ€åä¸€ä¸ªäº¤å‰å¼•ç”¨çš„ç±»å‹ã€‚å¯¹äºä»£ç äº¤å‰å¼•ç”¨ï¼Œè¿™äº›å¸¸é‡åŒ…æ‹¬fl_CN(è¿‘è°ƒç”¨)ã€fl_CF(è¿œè°ƒç”¨)ã€f1_JNï¼ˆè¿‘è·³è½¬)ã€f1_JFï¼ˆè¿œè·³è½¬ï¼‰å’Œf1_F(æ™®é€šé¡ºåºæµ)ã€‚</p>
<h3 id="RfirstB"><a href="#RfirstB" class="headerlink" title="RfirstB"></a>RfirstB</h3><p>long RfirstB(long to)ï¼Œ</p>
<p>è¿”å› è½¬äº¤æ§åˆ¶æƒåˆ°ç»™å®šåœ°å€çš„ç¬¬ä¸€ä¸ªä½ç½®ã€‚</p>
<p>å¦‚æœä¸å­˜åœ¨å¯¹ç»™å®šåœ°å€çš„äº¤å‰å¼•ç”¨ï¼Œåˆ™è¿”å›BADADDR( -1 )ã€‚</p>
<h3 id="RnextB"><a href="#RnextB" class="headerlink" title="RnextB"></a>RnextB</h3><p>long RnextB(1ong to. long current)ï¼Œ</p>
<p>å¦‚æœcurrent å·²ç»åœ¨å‰ä¸€æ¬¡è°ƒç”¨RfirstBæˆ–RnextBæ—¶è¿”å›ï¼Œåˆ™è¿”å›ä¸‹ä¸€ä¸ªè½¬äº¤æ§åˆ¶æƒåˆ°ç»™å®šåœ°å€(to)çš„ä½ç½®ã€‚</p>
<p>å¦‚æœä¸å­˜åœ¨å…¶ä»–å¯¹ç»™å®šä½ç½®çš„äº¤å‰å¼•ç”¨ï¼Œåˆ™è¿”å›BADADDR ( -1 ).</p>
<p>æ¯æ¬¡è°ƒç”¨ä¸€ä¸ªäº¤å‰å¼•ç”¨å‡½æ•°ï¼Œ</p>
<p>IDAéƒ½ä¼šè®¾ç½®ä¸€ä¸ªå†…éƒ¨ IDCçŠ¶æ€å˜é‡,æŒ‡å‡ºè¿”å›çš„æœ€åä¸€ä¸ªäº¤å‰å¼•ç”¨çš„ç±»å‹ã€‚å¦‚æœéœ€è¦çŸ¥é“ä½ æ”¶åˆ°çš„äº¤å‰å¼•ç”¨çš„ç±»å‹,é‚£ä¹ˆåœ¨è°ƒç”¨å…¶ä»–äº¤å‰å¼•ç”¨æŸ¥è¯¢å‡½æ•°ä¹‹å‰ï¼Œå¿…é¡»è°ƒç”¨XrefTypeå‡½æ•°ã€‚</p>
<h2 id="æ•°æ®äº¤å‰å¼•ç”¨"><a href="#æ•°æ®äº¤å‰å¼•ç”¨" class="headerlink" title="æ•°æ®äº¤å‰å¼•ç”¨"></a>æ•°æ®äº¤å‰å¼•ç”¨</h2><p>è®¿é—®æ•°æ®äº¤å‰å¼•ç”¨ä¿¡æ¯çš„å‡½æ•°ä¸è®¿é—®ä»£ç äº¤å‰å¼•ç”¨ä¿¡æ¯çš„å‡½æ•°éå¸¸ç±»ä¼¼ã€‚è¿™äº›å‡½æ•°å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<h3 id="Dfirst"><a href="#Dfirst" class="headerlink" title="Dfirst"></a>Dfirst</h3><p>long Dfirst(long from)ï¼Œ</p>
<p>è¿”å›ç»™å®šåœ°å€å¼•ç”¨ä¸€ä¸ªæ•°æ®å€¼çš„ç¬¬â€“ä¸ªä½ç½®ã€‚</p>
<p>å¦‚æœç»™å®šåœ°å€æ²¡æœ‰å¼•ç”¨å…¶ä»–åœ°å€ï¼Œåˆ™è¿”å›BADADDR ( -1 )ã€‚</p>
<h3 id="Dnext"><a href="#Dnext" class="headerlink" title="Dnext"></a>Dnext</h3><p>long Dnext(1ong fromï¼Œlong current)</p>
<p>å¦‚æœcurrentå·²ç»åœ¨å‰â€“æ¬¡è°ƒç”¨Dfirstæˆ–Dnextæ—¶è¿”å›ï¼Œåˆ™è¿”å›ç»™å®šåœ°å€( from )</p>
<p>å‘å…¶å¼•ç”¨ä¸€ä¸ªæ•°æ®å€¼çš„ä¸‹ä¸€ä¸ªä½ç½®ã€‚</p>
<p>å¦‚æœæ²¡æœ‰å…¶ä»–äº¤å‰å¼•ç”¨å­˜åœ¨ï¼Œåˆ™è¿”å›BADADDRã€‚</p>
<h3 id="XrefType-1"><a href="#XrefType-1" class="headerlink" title="XrefType()"></a>XrefType()</h3><p>long XrefType()ï¼Œè¿”å›ä¸€ä¸ªå¸¸é‡ï¼Œè¯´æ˜æŸä¸ªäº¤å‰å¼•ç”¨æŸ¥è¯¢å‡½æ•°ï¼ˆå¦‚ Dfirst)è¿”å›çš„æœ€åä¸€ä¸ªäº¤å‰å¼•ç”¨çš„ç±»å‹ã€‚</p>
<p>å¯¹äºæ•°æ®äº¤å‰å¼•ç”¨ï¼Œè¿™äº›å¸¸é‡åŒ…æ‹¬dr_0(æä¾›çš„åç§»é‡)ã€dr_w(æ•°æ®å†™äººï¼‰å’Œdr_Rï¼ˆæ•°æ®è¯»å–)</p>
<h3 id="DfirstB"><a href="#DfirstB" class="headerlink" title="DfirstB"></a>DfirstB</h3><p>long DfirstB(1ong to)</p>
<p>è¿”å›å°†ç»™å®šåœ°å€ä½œä¸ºæ•°æ®å¼•ç”¨çš„ç¬¬ä¸€ä¸ªä½ç½®ã€‚</p>
<p>å¦‚æœä¸å­˜åœ¨å¼•ç”¨ç»™å®šåœ°å€çš„äº¤å‰å¼•ç”¨ï¼Œåˆ™è¿”å›BADADDR ( -1 )ã€‚</p>
<h3 id="DnextB"><a href="#DnextB" class="headerlink" title="DnextB"></a>DnextB</h3><p>long DnextB(long toï¼Œ1ong current)ï¼Œå¦‚æœcurrnet å·²ç»åœ¨å‰ä¸€æ¬¡è°ƒç”¨DfristBæˆ–DnextBæ—¶è¿”å›ï¼Œåˆ™è¿”å›å°†ç»™å®šåœ°å€( to)ä½œä¸ºæ•°æ®å¼•ç”¨çš„ä¸‹ä¸€æ¬¡ä½ç½®ã€‚å¦‚æœæ²¡æœ‰å…¶ä»–å¯¹ç»™å®šåœ°å€çš„äº¤å‰å¼•ç”¨å­˜åœ¨ï¼Œåˆ™è¿”å›BADADDRã€‚<br>å’Œä»£ç äº¤å‰å¼•ç”¨ä¸€æ ·ï¼Œå¦‚æœéœ€è¦çŸ¥é“ä½ æ”¶åˆ°çš„äº¤å‰å¼•ç”¨çš„ç±»å‹ï¼Œé‚£ä¹ˆåœ¨è°ƒç”¨å¦ä¸€ä¸ªäº¤å‰å¼•ç”¨æŸ¥è¯¢å‡½æ•°ä¹‹å‰ï¼Œå¿…é¡»è°ƒç”¨XrefTypeå‡½æ•°ã€‚</p>
<h2 id="åæ±‡ç¼–æå–"><a href="#åæ±‡ç¼–æå–" class="headerlink" title="åæ±‡ç¼–æå–"></a>åæ±‡ç¼–æå–</h2><p>è®¸å¤šæ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ä»åæ±‡ç¼–ä»£ç æ¸…å•çš„åæ±‡ç¼–è¡Œä¸­æå–å‡ºæ–‡æœ¬æˆ–æ–‡æœ¬çš„æŸä¸ªéƒ¨åˆ†ã€‚ä¸‹é¢çš„å‡½æ•°å¯ç”¨äºè®¿é—®åæ±‡ç¼–è¡Œçš„å„ç§ç»„ä»¶</p>
<h3 id="GetDisasm"><a href="#GetDisasm" class="headerlink" title="GetDisasm"></a>GetDisasm</h3><p>string GetDisasm(long addr)ï¼Œè¿”å›ç»™å®šåœ°å€çš„åæ±‡ç¼–æ–‡æœ¬ã€‚è¿”å›çš„æ–‡æœ¬åŒ…æ‹¬ä»»ä½•æ³¨é‡Šï¼Œä½†ä¸åŒ…æ‹¬åœ°å€ä¿¡æ¯</p>
<p>è¿”å›è¯¥åœ°å€çš„åæ±‡ç¼–æŒ‡ä»¤</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;idc.idc&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">auto</span> currAddr=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">auto</span> op =<span class="string">&quot; &quot;</span>;  </span><br><span class="line">    currAddr	= ScreenEA();</span><br><span class="line">    op=GetDisasm(currAddr);</span><br><span class="line">    Message(<span class="string">&quot;%s\n&quot;</span>,op);   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov     edx, dword_445BD8</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„è¿”å›çš„å­—ç¬¦ä¸²,movå’Œedxä¹‹é—´æ˜¯4ä¸ªç©ºæ ¼</p>
<h3 id="GetMnem"><a href="#GetMnem" class="headerlink" title="GetMnem"></a>GetMnem</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string GetMnem( auto addr)</span><br></pre></td></tr></table></figure>

<p>è¿”å›ä½äºç»™å®šåœ°å€çš„æ±‡ç¼–æŒ‡ä»¤,æ¯”å¦‚è¿”å›â€callâ€,â€jmpâ€</p>
<p>å¦‚æœè¯¥åœ°å€æ²¡æœ‰æŒ‡ä»¤ä¸ä¹‹åŒ¹é…å°±è¿”å›â€ â€œ</p>
<h3 id="GetOpnd"><a href="#GetOpnd" class="headerlink" title="GetOpnd"></a>GetOpnd</h3><p>string GetOpnd(long addr. long opnum)ï¼Œ</p>
<p>è¿”å›æŒ‡å®šåœ°å€æ±‡ç¼–æŒ‡ä»¤çš„çš„æ“ä½œæ•°</p>
<p>IDAä»¥0ä¸ºèµ·å§‹ç¼–å·ï¼Œä»å·¦å‘å³å¯¹æ“ä½œæ•°ç¼–å·ã€‚</p>
<h3 id="GetOpType"><a href="#GetOpType" class="headerlink" title="GetOpType"></a>GetOpType</h3><p>long GetOpType(long addr.long opnum)ï¼Œè¿”å›ä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å‡ºç»™å®šåœ°å€çš„ç»™å®šæ“ä½œæ•°çš„ç±»å‹ã€‚è¯·å‚è€ƒGetOpTypeçš„ IDCæ–‡æ¡£ï¼Œäº†è§£æ“ä½œæ•°ç±»å‹ä»£ç ã€‚</p>
<h3 id="GetOperandValue"><a href="#GetOperandValue" class="headerlink" title="GetOperandValue"></a>GetOperandValue</h3><p>long GetOperandValue(long addr. long opnum)ï¼Œè¿”å›ä¸ç»™å®šåœ°å€çš„ç»™å®šæ“ä½œæ•°æœ‰å…³çš„æ•´æ•°å€¼ã€‚è¿”å›å€¼çš„æ€§è´¨å–å†³äºGetOpTypeæŒ‡å®šçš„ç»™å®šæ“ä½œæ•°çš„ç±»å‹ã€‚<br>15.5 IDCè„šæœ¬ç¤ºä¾‹211<br>string CommentEx(long addr. long type)ï¼Œè¿”å›ç»™å®šåœ°å€å¤„çš„æ³¨é‡Šæ–‡æœ¬ã€‚å¦‚æœtypeä¸º0,åˆ™è¿”å›å¸¸è§„æ³¨é‡Šçš„æ–‡æœ¬;å¦‚æœtypeä¸º1ï¼Œåˆ™è¿”å›å¯é‡å¤æ³¨é‡Šçš„æ–‡æœ¬ã€‚å¦‚æœç»™å®šåœ°å€å¤„æ²¡æœ‰æ³¨é‡Š,åˆ™è¿”å›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚</p>
<h2 id="misc-func"><a href="#misc-func" class="headerlink" title="misc-func"></a>misc-func</h2><p>MinEA() MaxEA() è·å–å½“å‰idb çš„æœ€å°åœ°å€ å’Œ æœ€å¤§åœ°å€</p>
<p>ScreenEA() è·å–å½“å‰å…‰æ ‡æ‰€åœ¨è¡Œçš„åœ°å€, è¿”å›ä¸€ä¸ª int ç±»å‹</p>
<p>SegName(ea) eaæ˜¯ä¸€ä¸ªå˜é‡å­˜å‚¨å½“å‰åœ°å€, è¿™ä¸ªapi æ˜¯è·å–å½“å‰åœ°å€æ‰€åœ¨çš„æ®µ</p>
<p>GetDisasm(ea) è·å–å½“å‰åœ°å€çš„åæ±‡ç¼–ä»£ç </p>
<p>GetMnem(ea) è·å–å½“å‰åœ°å€çš„æ“ä½œç </p>
<p>GetOpnd(ea,0) è·å–å½“å‰åœ°å€çš„æ“ä½œæ•°,ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºå“ªä¸€ä¸ªæ“ä½œæ•°</p>
<p>SegStart(ea) è·å–å½“å‰åœ°å€æ‰€åœ¨æ®µçš„èµ·å§‹åœ°å€</p>
<p>SegEnd(ea) è·å–å½“å‰åœ°å€çš„æ®µå°¾åœ°å€</p>
<p>NextSeg(ea) è·å–ä¸‹ä¸€ä¸ªæ®µçš„èµ·å§‹åœ°å€</p>
<p>idautils.Segments() è¿”å›ä¸€ä¸ªå¯è¿­ä»£çš„å¯¹è±¡æ•°ç»„</p>
<p>GetFunctionName(func) é€šè¿‡åœ°å€,è·å–å‡½æ•°çš„åç§°</p>
<p>idautils.Functions() è¿”å›ä¸€ä¸ªå¯è¿­ä»£çš„å‡½æ•°é¦–åœ°å€æ•°ç»„,</p>
<p>idaapi.get_func(ea) è·å–å½“å‰åœ°å€çš„å‡½æ•°é¦–åœ°å€å’Œå°¾åœ°å€</p>
<p>NextFunction(ea) è·å–ä¸‹ä¸€ä¸ªå‡½æ•°åœ°å€,eaçš„å€¼å¯èƒ½åœ¨å‡½æ•°é‡Œé¢,ä¹Ÿå¯èƒ½åœ¨å‡½æ•°å¤–é¢,ä½†æ˜¯ä¼šè¿”å›ä¸‹ä¸€ä¸ªå‡½æ•°çš„é¦–åœ°å€</p>
<p>PrevFunction(ea) è·å–å‰ä¸€ä¸ªå‡½æ•°åœ°å€</p>
<p>GetFunctionAttr(ea,FUNCATTR_START) è·å–ä¸€ä¸ªå‡½æ•°çš„è¾¹ç•Œåœ°å€</p>
<p>GetDunctionAttr(ea,FUNCATTR_END) è·å–ä¸€ä¸ªå‡½æ•°çš„è¾¹ç•Œåœ°å€</p>
<p>NextHead</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">auto NextHead(auto å½“å‰åœ°å€,auto ç»“å°¾åœ°å€) </span><br><span class="line">//head = NextHead(startOEP, End_FUnc);</span><br><span class="line">//head = NextHead(0x00000000, 0xFFFFFFFF);</span><br></pre></td></tr></table></figure>

<p>è·å–ä¸€ä¸ªå½“å‰æŒ‡ä»¤çš„ä¸‹ä¸€ä¸ªæŒ‡ä»¤çš„åœ°å€,éå†ç»“æŸè¿”å›-1</p>
<p>SetColor</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SetColor(auto åœ°å€, CIC_ITEM,  16è¿›åˆ¶é¢œè‰²å€¼);</span><br></pre></td></tr></table></figure>



<p>get_idb_path()[0:-4]</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;idc.idc&gt;</span></span></span><br><span class="line"><span class="type">static</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    Message(<span class="string">&quot;%s\n&quot;</span>,get_idb_path()[<span class="number">0</span>:<span class="number">-4</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è¾“å‡ºå½“å‰æ–‡ä»¶æ‰€åœ¨ç›®å½•,å…·ä½“æ˜¯å½“å‰idbæ–‡ä»¶æ‰€åœ¨ç›®å½•</span></span><br></pre></td></tr></table></figure>



<h1 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h1><p>ä¸€ä¸ªå¾ˆå¥½çš„IDAèµ„æºæ’ä»¶ä»‹ç»,æ²¡å»ä¸‹è½½åº”ç”¨</p>
<p><a target="_blank" rel="noopener" href="https://www.dazhuanlan.com/sisiyoki/topics/1183415">https://www.dazhuanlan.com/sisiyoki/topics/1183415</a></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/re4mile/">Home</a></li>
         
          <li><a href="/re4mile/categories/">ç›®å½•</a></li>
         
          <li><a href="/re4mile/tags/">æ ‡ç­¾</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://re4mile.notion.site/Recording-128f15b4906c43f19c64e7be1b6011cc">æ—¥å¸¸è®°å½•</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#IDC%E8%84%9A%E6%9C%AC"><span class="toc-number">1.</span> <span class="toc-text">IDCè„šæœ¬</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5"><span class="toc-number">1.1.</span> <span class="toc-text">å‚è€ƒé“¾æ¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HeloWorld"><span class="toc-number">1.2.</span> <span class="toc-text">HeloWorld</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.3.</span> <span class="toc-text">æ•°æ®ç±»å‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C"><span class="toc-number">1.3.1.</span> <span class="toc-text">å­—ç¬¦ä¸²æ“ä½œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E7%BB%84"><span class="toc-number">1.3.2.</span> <span class="toc-text">æ•°ç»„</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.4.</span> <span class="toc-text">è¿ç®—ç¬¦</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%AE%9A%E4%B9%89"><span class="toc-number">1.5.</span> <span class="toc-text">å‡½æ•°å®šä¹‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%8F%E5%AE%9A%E4%B9%89"><span class="toc-number">1.6.</span> <span class="toc-text">å®å®šä¹‰</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#IDC-Example"><span class="toc-number">2.</span> <span class="toc-text">IDC-Example</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#patch"><span class="toc-number">2.1.</span> <span class="toc-text">patch</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AB%98%E4%BA%AE"><span class="toc-number">2.2.</span> <span class="toc-text">é«˜äº®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dump%E6%95%B0%E6%8D%AE"><span class="toc-number">2.3.</span> <span class="toc-text">dumpæ•°æ®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E6%87%82"><span class="toc-number">2.4.</span> <span class="toc-text">ä¸æ‡‚</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#IDC-API"><span class="toc-number">3.</span> <span class="toc-text">IDC-API</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%8B%E5%86%8C"><span class="toc-number">3.1.</span> <span class="toc-text">æ‰‹å†Œ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%8F%96%E4%BF%AE%E6%94%B9"><span class="toc-number">3.2.</span> <span class="toc-text">æ•°æ®è¯»å–ä¿®æ”¹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PatchByte-x2F-Word-x2F-Dword"><span class="toc-number">3.2.1.</span> <span class="toc-text">PatchByte&#x2F;Word&#x2F;Dword</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Byte-x2F-Word-x2F-Dword"><span class="toc-number">3.2.2.</span> <span class="toc-text">Byte&#x2F;Word&#x2F;Dword</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#isLoaded"><span class="toc-number">3.2.3.</span> <span class="toc-text">isLoaded</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E4%BA%A4%E4%BA%92%E5%87%BD%E6%95%B0"><span class="toc-number">3.3.</span> <span class="toc-text">ç”¨æˆ·äº¤äº’å‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Message"><span class="toc-number">3.3.1.</span> <span class="toc-text">Message</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#print"><span class="toc-number">3.3.2.</span> <span class="toc-text">print</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#warning"><span class="toc-number">3.3.3.</span> <span class="toc-text">warning</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AskStr"><span class="toc-number">3.3.4.</span> <span class="toc-text">AskStr</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AskFile"><span class="toc-number">3.3.5.</span> <span class="toc-text">AskFile</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AskYN"><span class="toc-number">3.3.6.</span> <span class="toc-text">AskYN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ScreenEA"><span class="toc-number">3.3.7.</span> <span class="toc-text">ScreenEA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jump"><span class="toc-number">3.3.8.</span> <span class="toc-text">Jump</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C%E5%87%BD%E6%95%B0"><span class="toc-number">3.4.</span> <span class="toc-text">å­—ç¬¦ä¸²æ“ä½œå‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#form"><span class="toc-number">3.4.1.</span> <span class="toc-text">form</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sprintf"><span class="toc-number">3.4.2.</span> <span class="toc-text">sprintf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#atol"><span class="toc-number">3.4.3.</span> <span class="toc-text">atol</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xtol"><span class="toc-number">3.4.4.</span> <span class="toc-text">xtol</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ltoa"><span class="toc-number">3.4.5.</span> <span class="toc-text">ltoa</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ord"><span class="toc-number">3.4.6.</span> <span class="toc-text">ord</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#strlen"><span class="toc-number">3.4.7.</span> <span class="toc-text">strlen</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#strstr"><span class="toc-number">3.4.8.</span> <span class="toc-text">strstr</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#substr"><span class="toc-number">3.4.9.</span> <span class="toc-text">substr</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="toc-number">3.5.</span> <span class="toc-text">æ–‡ä»¶æ“ä½œ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#fopen"><span class="toc-number">3.5.1.</span> <span class="toc-text">fopen</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fclose"><span class="toc-number">3.5.2.</span> <span class="toc-text">fclose</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#filelength"><span class="toc-number">3.5.3.</span> <span class="toc-text">filelength</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fgetc"><span class="toc-number">3.5.4.</span> <span class="toc-text">fgetc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fputc"><span class="toc-number">3.5.5.</span> <span class="toc-text">fputc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fprintf"><span class="toc-number">3.5.6.</span> <span class="toc-text">fprintf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#writestr"><span class="toc-number">3.5.7.</span> <span class="toc-text">writestr</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#readstr"><span class="toc-number">3.5.8.</span> <span class="toc-text">readstr</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#writelong"><span class="toc-number">3.5.9.</span> <span class="toc-text">writelong</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#readlong"><span class="toc-number">3.5.10.</span> <span class="toc-text">readlong</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#writeshort"><span class="toc-number">3.5.11.</span> <span class="toc-text">writeshort</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#readshort"><span class="toc-number">3.5.12.</span> <span class="toc-text">readshort</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#loadfile"><span class="toc-number">3.5.13.</span> <span class="toc-text">loadfile</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#savefile"><span class="toc-number">3.5.14.</span> <span class="toc-text">savefile</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8D%E7%A7%B0"><span class="toc-number">3.6.</span> <span class="toc-text">æ“ä½œæ•°æ®åº“åç§°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Name"><span class="toc-number">3.6.1.</span> <span class="toc-text">Name</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NameEx"><span class="toc-number">3.6.2.</span> <span class="toc-text">NameEx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MakeNameEx"><span class="toc-number">3.6.3.</span> <span class="toc-text">MakeNameEx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LocByName"><span class="toc-number">3.6.4.</span> <span class="toc-text">LocByName</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LocByNameEx"><span class="toc-number">3.6.5.</span> <span class="toc-text">LocByNameEx</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%87%BD%E6%95%B0"><span class="toc-number">3.7.</span> <span class="toc-text">æ“ä½œæ•°æ®åº“çš„å‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MakeUnkn"><span class="toc-number">3.7.1.</span> <span class="toc-text">MakeUnkn</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MakeCode"><span class="toc-number">3.7.2.</span> <span class="toc-text">MakeCode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MakeByte"><span class="toc-number">3.7.3.</span> <span class="toc-text">MakeByte</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MakeComm"><span class="toc-number">3.7.4.</span> <span class="toc-text">MakeComm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MakeFunction"><span class="toc-number">3.7.5.</span> <span class="toc-text">MakeFunction</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MakeStr"><span class="toc-number">3.7.6.</span> <span class="toc-text">MakeStr</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%90%9C%E7%B4%A2%E5%87%BD%E6%95%B0"><span class="toc-number">3.8.</span> <span class="toc-text">æ•°æ®åº“æœç´¢å‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#FindCode"><span class="toc-number">3.8.1.</span> <span class="toc-text">FindCode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FindData"><span class="toc-number">3.8.2.</span> <span class="toc-text">FindData</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FindBinary"><span class="toc-number">3.8.3.</span> <span class="toc-text">FindBinary</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FindText"><span class="toc-number">3.8.4.</span> <span class="toc-text">FindText</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E5%87%BD%E6%95%B0"><span class="toc-number">3.9.</span> <span class="toc-text">æ“ä½œå‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GetFunctionAttr"><span class="toc-number">3.9.1.</span> <span class="toc-text">GetFunctionAttr</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GetFunctionName"><span class="toc-number">3.9.2.</span> <span class="toc-text">GetFunctionName</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NextFunction"><span class="toc-number">3.9.3.</span> <span class="toc-text">NextFunction</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PrevFunction"><span class="toc-number">3.9.4.</span> <span class="toc-text">PrevFunction</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E4%BA%A4%E5%8F%89%E5%BC%95%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-number">3.10.</span> <span class="toc-text">ä»£ç äº¤å‰å¼•ç”¨å‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Rfirst"><span class="toc-number">3.10.1.</span> <span class="toc-text">Rfirst</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Rnext"><span class="toc-number">3.10.2.</span> <span class="toc-text">Rnext</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XrefType"><span class="toc-number">3.10.3.</span> <span class="toc-text">XrefType</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RfirstB"><span class="toc-number">3.10.4.</span> <span class="toc-text">RfirstB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RnextB"><span class="toc-number">3.10.5.</span> <span class="toc-text">RnextB</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BA%A4%E5%8F%89%E5%BC%95%E7%94%A8"><span class="toc-number">3.11.</span> <span class="toc-text">æ•°æ®äº¤å‰å¼•ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Dfirst"><span class="toc-number">3.11.1.</span> <span class="toc-text">Dfirst</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dnext"><span class="toc-number">3.11.2.</span> <span class="toc-text">Dnext</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XrefType-1"><span class="toc-number">3.11.3.</span> <span class="toc-text">XrefType()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DfirstB"><span class="toc-number">3.11.4.</span> <span class="toc-text">DfirstB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DnextB"><span class="toc-number">3.11.5.</span> <span class="toc-text">DnextB</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E6%B1%87%E7%BC%96%E6%8F%90%E5%8F%96"><span class="toc-number">3.12.</span> <span class="toc-text">åæ±‡ç¼–æå–</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GetDisasm"><span class="toc-number">3.12.1.</span> <span class="toc-text">GetDisasm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GetMnem"><span class="toc-number">3.12.2.</span> <span class="toc-text">GetMnem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GetOpnd"><span class="toc-number">3.12.3.</span> <span class="toc-text">GetOpnd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GetOpType"><span class="toc-number">3.12.4.</span> <span class="toc-text">GetOpType</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GetOperandValue"><span class="toc-number">3.12.5.</span> <span class="toc-text">GetOperandValue</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-func"><span class="toc-number">3.13.</span> <span class="toc-text">misc-func</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%99%84%E5%BD%95"><span class="toc-number">4.</span> <span class="toc-text">é™„å½•</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://gitee.com/re4mile/re4mile.git/2022/12/05/Reverse-Tool-IDC%E8%84%9A%E6%9C%AC/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://gitee.com/re4mile/re4mile.git/2022/12/05/Reverse-Tool-IDC%E8%84%9A%E6%9C%AC/&text=IDCè„šæœ¬å­¦ä¹ "><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://gitee.com/re4mile/re4mile.git/2022/12/05/Reverse-Tool-IDC%E8%84%9A%E6%9C%AC/&title=IDCè„šæœ¬å­¦ä¹ "><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://gitee.com/re4mile/re4mile.git/2022/12/05/Reverse-Tool-IDC%E8%84%9A%E6%9C%AC/&is_video=false&description=IDCè„šæœ¬å­¦ä¹ "><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=IDCè„šæœ¬å­¦ä¹ &body=Check out this article: https://gitee.com/re4mile/re4mile.git/2022/12/05/Reverse-Tool-IDC%E8%84%9A%E6%9C%AC/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://gitee.com/re4mile/re4mile.git/2022/12/05/Reverse-Tool-IDC%E8%84%9A%E6%9C%AC/&title=IDCè„šæœ¬å­¦ä¹ "><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://gitee.com/re4mile/re4mile.git/2022/12/05/Reverse-Tool-IDC%E8%84%9A%E6%9C%AC/&title=IDCè„šæœ¬å­¦ä¹ "><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://gitee.com/re4mile/re4mile.git/2022/12/05/Reverse-Tool-IDC%E8%84%9A%E6%9C%AC/&title=IDCè„šæœ¬å­¦ä¹ "><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://gitee.com/re4mile/re4mile.git/2022/12/05/Reverse-Tool-IDC%E8%84%9A%E6%9C%AC/&title=IDCè„šæœ¬å­¦ä¹ "><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://gitee.com/re4mile/re4mile.git/2022/12/05/Reverse-Tool-IDC%E8%84%9A%E6%9C%AC/&name=IDCè„šæœ¬å­¦ä¹ &description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://gitee.com/re4mile/re4mile.git/2022/12/05/Reverse-Tool-IDC%E8%84%9A%E6%9C%AC/&t=IDCè„šæœ¬å­¦ä¹ "><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2022
    D0g3.re4mile
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/re4mile/">Home</a></li><!--
     --><!--
       --><li><a href="/re4mile/categories/">ç›®å½•</a></li><!--
     --><!--
       --><li><a href="/re4mile/tags/">æ ‡ç­¾</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://re4mile.notion.site/Recording-128f15b4906c43f19c64e7be1b6011cc">æ—¥å¸¸è®°å½•</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/re4mile/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
